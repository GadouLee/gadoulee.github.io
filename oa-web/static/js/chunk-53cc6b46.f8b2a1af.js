(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-53cc6b46"],{1825:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"newApproval"},[e._e(),a("div",{staticStyle:{width:"650px",margin:"0 auto"}},[0==e.active?a("el-form",{ref:"ruleForm",staticClass:"newApprovalForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"150px",size:"medium"}},[e.step?e._e():a("el-form-item",{attrs:{label:"项目名称",prop:"project_id"}},[a("el-select",{attrs:{disabled:e.disableFlag,placeholder:"请选择",filterable:"",clearable:""},on:{change:e.handleProjectChange},model:{value:e.ruleForm.project_id,callback:function(t){e.$set(e.ruleForm,"project_id",t)},expression:"ruleForm.project_id"}},e._l(e.projectList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.project_name,value:e.id}})})),1)],1),e.step?e._e():a("el-form-item",{attrs:{label:"项目负责人",prop:"contacts_name"}},[a("el-select",{attrs:{disabled:!0,placeholder:"请选择",filterable:"",clearable:""},model:{value:e.ruleForm.contacts_name,callback:function(t){e.$set(e.ruleForm,"contacts_name",t)},expression:"ruleForm.contacts_name"}},e._l(e.projectList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.contacts_name,value:e.id}})})),1)],1),e.step?e._e():a("el-form-item",{attrs:{label:"招标公司",prop:"company_id"}},[a("el-select",{attrs:{disabled:!0,placeholder:"请选择",filterable:"",clearable:""},model:{value:e.ruleForm.company_id,callback:function(t){e.$set(e.ruleForm,"company_id",t)},expression:"ruleForm.company_id"}},e._l(e.companyList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),e.step?e._e():a("el-form-item",{attrs:{label:"投标公司",prop:"bid_company_id"}},[a("el-select",{attrs:{disabled:!0,placeholder:"请选择",filterable:"",clearable:""},model:{value:e.ruleForm.bid_company_id,callback:function(t){e.$set(e.ruleForm,"bid_company_id",t)},expression:"ruleForm.bid_company_id"}},e._l(e.companyList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"付款方式",prop:"pay_type"}},[a("el-select",{attrs:{disabled:e.disableFlag,placeholder:"请选择",filterable:"",clearable:""},model:{value:e.ruleForm.pay_type,callback:function(t){e.$set(e.ruleForm,"pay_type",t)},expression:"ruleForm.pay_type"}},e._l(e.payTypeList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"付款账户类型",prop:"payment_type"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择付款账户类型",disabled:e.detailToCreate},model:{value:e.ruleForm.payment_type,callback:function(t){e.$set(e.ruleForm,"payment_type",t)},expression:"ruleForm.payment_type"}},[a("el-option",{attrs:{label:"公司",value:1}}),a("el-option",{attrs:{label:"个人",value:2}})],1)],1),1==e.ruleForm.payment_type?[a("el-form-item",{attrs:{label:"付款方",prop:"payment_company_id"}},[a("el-select",{attrs:{disabled:e.disableFlag,placeholder:"请选择",filterable:"",clearable:""},model:{value:e.ruleForm.payment_company_id,callback:function(t){e.$set(e.ruleForm,"payment_company_id",t)},expression:"ruleForm.payment_company_id"}},e._l(e.companyList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),1==e.ruleForm.pay_type||4==e.ruleForm.pay_type?a("el-form-item",{attrs:{label:"付款账号",prop:"payment_company_bank_id"}},[a("el-select",{attrs:{disabled:!e.ruleForm.payment_company_id||e.disableFlag,placeholder:"请选择",filterable:"",clearable:""},model:{value:e.ruleForm.payment_company_bank_id,callback:function(t){e.$set(e.ruleForm,"payment_company_bank_id",t)},expression:"ruleForm.payment_company_bank_id"}},e._l(e.companyListAccount,(function(e){return a("el-option",{key:e.id,attrs:{label:e.open_bank+":"+e.bank_number,value:e.id}})})),1)],1):e._e()]:e._e(),2==e.ruleForm.payment_type?[a("el-form-item",{attrs:{label:"个人付款id",prop:"payment_staff_id"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",clearable:"",filterable:""},model:{value:e.ruleForm.payment_staff_id,callback:function(t){e.$set(e.ruleForm,"payment_staff_id",t)},expression:"ruleForm.payment_staff_id"}},e._l(e.staffList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),1==e.ruleForm.pay_type||4==e.ruleForm.pay_type?a("el-form-item",{attrs:{label:"个人付款账户",prop:"payment_staff_bank_id"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",clearable:"",filterable:""},model:{value:e.ruleForm.payment_staff_bank_id,callback:function(t){e.$set(e.ruleForm,"payment_staff_bank_id",t)},expression:"ruleForm.payment_staff_bank_id"}},e._l(e.payment_staff_bank_idArr,(function(e){return a("el-option",{key:e.id,attrs:{label:e.open_bank+":"+e.bank_number,value:e.id}})})),1)],1):e._e()]:e._e(),a("el-form-item",{attrs:{label:"收款账户类型",prop:"revenue_type"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择收款账户类型",disabled:e.detailToCreate},model:{value:e.ruleForm.revenue_type,callback:function(t){e.$set(e.ruleForm,"revenue_type",t)},expression:"ruleForm.revenue_type"}},[a("el-option",{attrs:{label:"公司",value:1}}),a("el-option",{attrs:{label:"个人",value:2}})],1)],1),1==e.ruleForm.revenue_type?[a("el-form-item",{attrs:{label:"收款方",prop:"revenue_company_id"}},[a("el-select",{attrs:{disabled:e.disableFlag,placeholder:"请选择",filterable:"",clearable:""},model:{value:e.ruleForm.revenue_company_id,callback:function(t){e.$set(e.ruleForm,"revenue_company_id",t)},expression:"ruleForm.revenue_company_id"}},e._l(e.companyList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),1==e.ruleForm.pay_type||4==e.ruleForm.pay_type?a("el-form-item",{attrs:{label:"收款账户",prop:"revenue_company_bank_id"}},[a("el-select",{attrs:{disabled:!e.ruleForm.revenue_company_id||e.disableFlag,placeholder:"请选择",filterable:"",clearable:""},model:{value:e.ruleForm.revenue_company_bank_id,callback:function(t){e.$set(e.ruleForm,"revenue_company_bank_id",t)},expression:"ruleForm.revenue_company_bank_id"}},e._l(e.companyListAccountRevenue,(function(e){return a("el-option",{key:e.id,attrs:{label:e.open_bank+":"+e.bank_number,value:e.id}})})),1)],1):e._e()]:e._e(),2==e.ruleForm.revenue_type?[a("el-form-item",{attrs:{label:"个人收款id",prop:"revenue_staff_id"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",clearable:"",filterable:""},model:{value:e.ruleForm.revenue_staff_id,callback:function(t){e.$set(e.ruleForm,"revenue_staff_id",t)},expression:"ruleForm.revenue_staff_id"}},e._l(e.staffList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),1==e.ruleForm.pay_type||4==e.ruleForm.pay_type?a("el-form-item",{attrs:{label:"个人收款账户",prop:"revenue_staff_bank_id"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",filterable:"",clearable:""},model:{value:e.ruleForm.revenue_staff_bank_id,callback:function(t){e.$set(e.ruleForm,"revenue_staff_bank_id",t)},expression:"ruleForm.revenue_staff_bank_id"}},e._l(e.revenue_staff_idArr,(function(e){return a("el-option",{key:e.id,attrs:{label:e.open_bank+":"+e.bank_number,value:e.id}})})),1)],1):e._e()]:e._e(),a("el-form-item",{attrs:{label:"付款金额",prop:"payment_money"}},[a("el-input",{staticClass:"moneyStyle",attrs:{title:e.ruleForm.payment_money,disabled:e.disableFlag,placeholder:"请输入"},model:{value:e.ruleForm.payment_money,callback:function(t){e.$set(e.ruleForm,"payment_money",t)},expression:"ruleForm.payment_money"}})],1),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{title:e.ruleForm.remarks,placeholder:"请输入",disabled:e.disableFlag},model:{value:e.ruleForm.remarks,callback:function(t){e.$set(e.ruleForm,"remarks",t)},expression:"ruleForm.remarks"}})],1),2==e.active?a("el-form-item",{attrs:{label:"备注信息",prop:"remarks"}},[a("el-input",{attrs:{title:e.ruleForm.remarks,disabled:e.disableFlag,type:"textarea"},model:{value:e.ruleForm.remarks,callback:function(t){e.$set(e.ruleForm,"remarks",t)},expression:"ruleForm.remarks"}})],1):e._e(),a("el-form-item",{attrs:{label:"相关附件",prop:"receipt"}},[a("el-upload",{staticClass:"upload-demo",attrs:{action:"##","file-list":e.fileList,"before-upload":e.beforUpload,"on-remove":e.handleRemove,"before-remove":e.beforeRemove,"on-preview":e.handleDown}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1)],1),a("el-form-item",[a("el-button",{staticStyle:{"margin-top":"12px"},attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("提交")])],1)],2):e._e()],1)])},n=[],l=a("c7eb"),i=a("1da1"),o=a("ade3"),s=(a("7db0"),a("d81d"),a("e9c4"),a("a9e3"),a("b64b"),a("d3b7"),a("0643"),a("fffc"),a("4e3e"),a("a573"),a("159b"),a("fef7")),p=a("277f"),c=a("9437"),m=a("ed08"),u={components:{ProgressBar:s["a"]},data:function(){var e=this;return{detailToCreate:!1,disableFlag:!1,step:!1,loding:!1,id:"",fileList:[],barWidth:"",active:0,payTypeList:[{label:"网银转账",value:1},{label:"现钞",value:2},{label:"担保手续",value:3},{label:"网银转账+担保手续",value:4},{label:"现钞+借据",value:5},{label:"投标保证金保函/保险",value:6}],arr:[{stepTitle:"客户垫付",stepDesc:""},{stepTitle:"支付投标人",stepDesc:""},{stepTitle:"支付招标方",stepDesc:""},{stepTitle:"退还投标人",stepDesc:""},{stepTitle:"退还集团",stepDesc:""},{stepTitle:"退还客户",stepDesc:"必须退回客户原账户"}],ruleForm:{project_id:"",payment_company_id:"",payment_company_bank_id:"",revenue_company_id:"",revenue_company_bank_id:"",payment_money:"",pay_type:"",remarks:"",payment_type:1,payment_staff_id:"",payment_staff_bank_id:"",revenue_type:1,revenue_staff_id:"",revenue_staff_bank_id:"",client_company_id:"",bid_company_id:"",contacts_name:"",company_id:""},rules:Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])({project_id:[{required:!0,message:"请选择项目名称",trigger:"change"}],payment_company_id:[{required:!0,message:"请选择付款方",trigger:"change"}],payment_company_bank_id:[{required:!0,message:"请选择付款账号",trigger:"change"}],payment_staff_id:[{required:!0,message:"请选择个人付款id",trigger:"change"}],payment_staff_bank_id:[{required:!0,message:"请选择个人付款账户",trigger:"change"}],revenue_company_id:[{required:!0,message:"请选择收款方",trigger:"change"}],revenue_company_bank_id:[{required:!0,message:"请选择收款账户",trigger:"change"}],revenue_staff_id:[{required:!0,message:"请选择个人收款id",trigger:"change"}],revenue_staff_bank_id:[{required:!0,message:"请选择个人收款账户",trigger:"change"}],payment_money:[{required:!0,message:"请输入付款金额",trigger:"blur"}],pay_type:[{required:!0,message:"请选择付款方式",trigger:"change"}],remarks:[{required:!0,message:"请输入备注信息",trigger:"blur"}],receipt:[{required:!0,validator:function(t,a,r){0==e.fileList.length?r(new Error("请上传银行回执/借据")):r()}}],client_company_id:[{required:!0,message:"请选择客户公司",trigger:"blur"}]},"payment_staff_id",[{required:!0,message:"请选择付款方",trigger:"blur"}]),"payment_staff_bank_id",[{required:!0,message:"请选择付款方账号",trigger:"blur"}]),"revenue_staff_id",[{required:!0,message:"请选择收款方",trigger:"blur"}]),"revenue_staff_bank_id",[{required:!0,message:"请选择收款账号",trigger:"blur"}]),companyList:[],projectList:[],companyListAccount:[],companyListAccountRevenue:[],payment_staff_bank_idArr:[],revenue_staff_idArr:[]}},computed:{staffList:function(){return this.$store.state.company.staffList}},watch:{"ruleForm.payment_company_id":{handler:function(e,t){var a=this;e!=t&&t&&(this.ruleForm.payment_company_bank_id=""),e?this.$store.state.company.companyList.forEach((function(t){t.id==e&&(a.companyListAccount=t.companyBankList)})):(this.ruleForm.payment_company_bank_id="",this.companyListAccount=[])},deep:!0},"ruleForm.revenue_company_id":{handler:function(e,t){var a=this;e!=t&&t&&(this.ruleForm.revenue_company_bank_id=""),e?this.$store.state.company.companyList.forEach((function(t){t.id==e&&(a.companyListAccountRevenue=t.companyBankList)})):(this.ruleForm.revenue_company_bank_id="",this.companyListAccountRevenue=[])},deep:!0},"ruleForm.payment_staff_id":{handler:function(e,t){var a=this;e!=t&&t&&(this.ruleForm.payment_staff_bank_id=""),e&&this.$store.state.company.staffList.map((function(t){t.id==e&&(a.payment_staff_bank_idArr=t.staffBankList)}))},deep:!0},"ruleForm.revenue_staff_id":{handler:function(e,t){var a=this;e!=t&&t&&(this.ruleForm.revenue_staff_bank_id=""),e&&this.$store.state.company.staffList.map((function(t){t.id==e&&(a.revenue_staff_idArr=t.staffBankList)}))},deep:!0},fileList:{handler:function(e,t){e.length>0&&this.$refs.ruleForm.validateField("receipt")},deep:!0}},mounted:function(){var e=this;if(this.companyList=this.$store.state.company.companyList,this.projectList=this.$store.state.company.projectList,this.$route.params.id&&(this.id=this.$route.params.id),this.$route.params.bindId&&(this.id=this.$route.params.bindId,this.disableFlag=!0),this.$route.params.step&&(this.step=this.$route.params.step,console.log(" this.step",this.step)),console.log("this.$route.params.data",this.$route.params.data),this.$route.params.data){var t=this.$route.params.data;this.fileList=t.file?JSON.parse(t.file).map((function(t){return{url:t,name:e.getFileName(t)}})):[],this.$store.state.company.companyList.map((function(a){a.id==t.payment_company_id&&(e.companyListAccount=a.companyBankList),a.id==t.revenue_company_id&&(e.companyListAccountRevenue=a.companyBankList)})),this.ruleForm={bid_company_id:t.client_company_id,payment_type:t.payment_type,revenue_type:t.revenue_type,project_id:this.$route.params.id,payment_company_id:t.payment_company_id,payment_company_bank_id:t.payment_company_bank_id?Number(t.payment_company_bank_id):"",revenue_company_id:t.payment_company_bank_id?Number(t.revenue_company_id):"",revenue_company_bank_id:t.revenue_company_bank_id?Number(t.revenue_company_bank_id):"",payment_money:t.payment_money,pay_type:t.pay_type?Number(t.pay_type):"",remarks:t.remarks,file:t.file,payment_staff_id:t.payment_staff_id,payment_staff_bank_id:t.payment_staff_bank_id,revenue_staff_id:t.revenue_staff_id,revenue_staff_bank_id:t.revenue_staff_bank_id},this.$forceUpdate(),console.log("this.ruleFormthis.ruleFormthis.ruleFormthis.ruleForm",this.ruleForm)}},methods:{beforUpload:function(e){var t=this,a=new FormData;return a.append("files",e),Object(c["a"])(a).then((function(a){200==a.code&&(e.url=a.data.file,t.fileList.push(e))})),!1},handleRemove:function(e,t){this.fileList=t},beforeRemove:function(){},getFileName:function(e){return-1!==e.lastIndexOf("?")?decodeURIComponent(e.substring(e.lastIndexOf("/")+1,e.lastIndexOf("?"))):decodeURIComponent(e.substring(e.lastIndexOf("/")+1))},submitForm:function(e){var t=this,a=this;this.$refs[e].validate(function(){var e=Object(i["a"])(Object(l["a"])().mark((function e(r){var n,i,o;return Object(l["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!r){e.next=18;break}if(t.ruleForm.file=JSON.stringify(t.fileList.map((function(e){return e.url}))),console.log("step,data",a.$route.params.step,a.$route.params.data),!a.$route.params.step&&!a.$route.params.data){e.next=11;break}return n=Object.assign(t.ruleForm,{phase:t.step,id:t.id}),e.next=7,Object(p["e"])(n);case 7:i=e.sent,200==i.code&&t.$router.push({path:"/bidSecurity-deposit/depositDetail",query:{id:t.id}}),e.next=15;break;case 11:return e.next=13,Object(p["c"])(t.ruleForm);case 13:o=e.sent,200==o.code&&t.$router.push({name:"depositList"});case 15:t.next(),e.next=20;break;case 18:return console.log("error submit!!"),e.abrupt("return",!1);case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},next:function(){this.active++>1&&(this.active=0)},handleDown:function(e){Object(m["a"])(e.url)},handleProjectChange:function(e){this.ruleForm.contacts_name=e;var t=this.projectList.find((function(t){return t.id==e}));this.ruleForm.company_id=t.company_id,this.ruleForm.bid_company_id=t.bid_company_id}}},d=u,_=(a("8be3"),a("2877")),f=Object(_["a"])(d,r,n,!1,null,"2b85820e",null);t["default"]=f.exports},"2f1f":function(e,t,a){},"7db0":function(e,t,a){"use strict";var r=a("23e7"),n=a("b727").find,l=a("44d2"),i=a("ae40"),o="find",s=!0,p=i(o);o in[]&&Array(1)[o]((function(){s=!1})),r({target:"Array",proto:!0,forced:s||!p},{find:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),l(o)},"8be3":function(e,t,a){"use strict";a("2f1f")},9437:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var r=a("b775");function n(e){return Object(r["a"])({url:"Publics/upload",method:"post",data:e,headers:{"content-type":"multipart/form-data"}})}},ed08:function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return o}));a("53ca"),a("d81d"),a("a434"),a("d3b7"),a("4d63"),a("ac1f"),a("2c3e"),a("00b4"),a("25f0"),a("4d90"),a("5319"),a("0643"),a("4e3e"),a("a573"),a("159b");var r=a("21a6"),n=a("25ca");a("bc3a"),a("aeb1");function l(e,t,a,l){var i=[],o=[],s=function(e){var t=0;for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t++;return t};for(var p in e)if(console.log("------------------------"),Object.prototype.hasOwnProperty.call(e,p)){var c=e[p],m=[];for(var u in c)if(Object.prototype.hasOwnProperty.call(c,u)){var d=c[u];m.push(d),o.length<s(c)&&o.push(u)}i.push(m)}var _=[];a.map((function(e,t){"快速操作"!=e&&"详情"!=e&&_.push(e)})),i.splice(0,0,o,_),console.log("excel_data",n);var f=n["utils"].aoa_to_sheet(i),y=n["utils"].book_new(),b=[{hidden:!0}];f["!rows"]=b,n["utils"].book_append_sheet(y,f,l);var v=n["write"](y,{bookType:"xlsx",type:"array"}),h=new Blob([v],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});Object(r["saveAs"])(h,t+".xlsx")}function i(e){var t=-1!==e.lastIndexOf("?")?decodeURIComponent(e.substring(e.lastIndexOf("/")+1,e.lastIndexOf("?"))):decodeURIComponent(e.substring(e.lastIndexOf("/")+1)),a=t.substring(t.lastIndexOf(".")+1);if("png"==a||"jpg"==a||"pdf"==a){var n=document.createElement("a");n.href=e,n.download=t,n.target="_blank",n.click()}else fetch(e,{mode:"no-cors"}).then((function(e){return e.blob()})).then((function(e){console.log("blob",e),Object(r["saveAs"])(e,t)}))}function o(e,t,a){console.log("self",e);var r=e.$router.resolve({name:t,query:a});window.open(r.href,"_blank")}},fffc:function(e,t,a){"use strict";var r=a("23e7"),n=a("2266"),l=a("1c0b"),i=a("825a");r({target:"Iterator",proto:!0,real:!0},{find:function(e){return i(this),l(e),n(this,(function(t){if(e(t))return n.stop(t)}),void 0,!1,!0).result}})}}]);