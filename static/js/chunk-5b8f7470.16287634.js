(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5b8f7470"],{"0993":function(t,e,a){t.exports=a.p+"static/img/checked.f8521b5f.png"},"227c":function(t,e,a){},"35ad":function(t,e,a){"use strict";a.d(e,"c",(function(){return r})),a.d(e,"a",(function(){return n})),a.d(e,"j",(function(){return o})),a.d(e,"e",(function(){return s})),a.d(e,"i",(function(){return c})),a.d(e,"f",(function(){return l})),a.d(e,"h",(function(){return d})),a.d(e,"b",(function(){return u})),a.d(e,"g",(function(){return m})),a.d(e,"d",(function(){return p}));var i=a("b775");function r(t){return Object(i["a"])({url:"/Contracts/info?id=".concat(t.id),method:"post",data:t})}function n(t){return Object(i["a"])({url:"/Contracts/add",method:"post",data:t})}function o(t){return Object(i["a"])({url:"/Contracts/update",method:"post",data:t})}function s(t){return Object(i["a"])({url:"/Contracts/delete",method:"post",data:t})}function c(t){return Object(i["a"])({url:"/Contracts/getProjectList",method:"post",data:t})}function l(t){return Object(i["a"])({url:"/Contracts/getAdministrativeList",method:"post",data:t})}function d(t){return Object(i["a"])({url:"/Contracts/getDraftList",method:"post",data:t})}function u(t){return Object(i["a"])({url:t.id?"/Contracts/editDraft":"/Contracts/draftAdd",method:"post",data:t})}function m(t){return Object(i["a"])({url:"/Contracts/draftInfo?id=".concat(t.id),method:"post",data:t})}function p(t){return Object(i["a"])({url:"/Contracts/delDraft",method:"post",data:t})}},6582:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAABAFJREFUaEPdWs9PE0EU/qYUo4IhGqDYgxBjBDXBRCV6MSb8AXrzZk0MxIM/DuoBDmgU6Qk9iB4sJ/Hm0cSjJqgHUPFHlLT4G6NNWwoIFKyF7jMz7eK23XZ3u93WuqemO/Pm+958896bmWUowOOnmS0VWD5EYG0A7QJYE4B6AFVJ84sAQgB9Bdg4Az2Po3LYyTZ9Mzs8y9eAn/y1Fah0EaSjANufnx0aZbDdi2N5yMmc4XxsGCbAvW3DygUApwEY7p8FJAG4KcHeb3RWDAEI0lQPgS4XEHg6H2JglxysrlfvbOgi4KepvTZIt/KXil44cjsalWA75WR1Y1o9NQkEKXiMwO5Y6PVsGImBjjuY424uEjkJBGnqHIGuaXnByvcM7LyD1V3PNkZWAv8CeBl0LhKqBJKyGbLSs0ZtM5BLTU4ZBBILlp6XQPNanEgCa0tf2BkEAhQcKV600cKcEWVHG5jjgPLfFALJOH/FqNlitmdgF5V5YpVAMsN+/QelkzENEuxNcsZeJRCg0A0AZ4rpTeVYQ9/u48jmdtRUVuuBMNDA6s/yhoIAL8xssIdK4X2JJFz1efAkPIbGKid6Wk6icb1TiwRJWKnnBaAgUKqYvyytwD3hwdPwq1XAeknIuUEQKEXk+R2PCc+PzLzJ8Pbummb0t/KCN9dDIiKx5OKd1JqzQr5fikfR5/Pg2cxbVbP6CAAS7I2s2Fk3El9Cn9eDF7PjquD1SiixgMnFihl95pYjQvMvZ72mwScNDLAABR8CrF2vRKZjc3gQGIZry2G9XUS72dg83BODeP3TVyjwAOgRn4FPALbqQTO55Eev7zYmF/04WLsH3c2dqLTZNbtOx37iqteDd/MfCghemPrMCSwA0MweSvAyigObWtHV0oGqinVZSYSi08Lz4/PcT5mPEc2rdI9wApKeBNbrvY3H4RcZNvZt3Imu5k7VDBqIhkW08S18sQI8t0mmCXArrTXb0d3Sgdo1G1eB/oiG4PYO4n2El1cF97xsUBDIW0JKWDs2bBVycq6tw/dfAfT5BvExon5uZVI2ymGFhPJaxGpe3VbdiK7mE3D7BvF58buVnpdt80VsLIyqLWYlUu5dHqUslI3CdCKMGi6jtUgUB7wYZSDvUsIIiQJqPsU3opQwU8zpIWEVeM5EFHP8h5lyOhcJK8EDyXKaEzC7oVEjYS14XokmTuwKtqVUkrAaPM/AKVvKhIyMR6P0aCNXqgY256rhVsefqZt63qHsj1WSa4FfYJTnwZY8bWYiko6pN9kkEXmURv6/w92ElMStTHker8vTYzY3mNRKWsmQ/Zbm/71i+jsTZXzJJ5Mo62tWpRjL9qJbSaKsPzVIJVKmH3uohcdSfm7zBx1kT++F89WDAAAAAElFTkSuQmCC"},6962:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"main"},[t.showSubmitBtn?t._e():i("div",{staticStyle:{position:"absolute",top:"50px",right:"300px","z-index":"10"}},["已审批"==t.state_name?i("img",{staticStyle:{display:"block",width:"150px"},attrs:{src:a("0993"),alt:""}}):t._e(),"审批中"==t.state_name?i("img",{staticStyle:{display:"block",width:"150px"},attrs:{src:a("9a04"),alt:""}}):t._e(),"已驳回"==t.state_name?i("img",{staticStyle:{display:"block",width:"150px"},attrs:{src:a("ac6f"),alt:""}}):t._e()]),t.showSubmitBtn?i("h3",{staticClass:"main-title",staticStyle:{display:"flex"}},[t._v(t._s(t.disabled?"详情":"签署合同")+" "),i("div",[t.permit_type_name?i("span",{staticStyle:{"padding-left":"20px",color:"#666666"}},[t._v("审批事项："+t._s(t.permit_type_name))]):t._e(),t.showIsTop?i("el-button",{staticStyle:{"margin-left":"50px"},attrs:{size:"small",type:"primary"},on:{click:t.handleTop}},[t._v(t._s(t.istop?"取消置顶":"置顶主页"))]):t._e()],1)]):t._e(),t.showSubmitBtn?t._e():i("h3",{staticClass:"main-title",staticStyle:{display:"flex","align-items":"center"}},[t._v("详情 "),i("div",[t.showIsTop?i("el-button",{staticStyle:{"margin-left":"50px"},attrs:{size:"small",type:"primary"},on:{click:t.handleTop}},[t._v(t._s(t.istop?"取消置顶":"置顶主页"))]):t._e()],1)]),i("div",{staticClass:"main-step"},[!t.disabled||t.showSubmitBtn?i("el-steps",{attrs:{active:t.active,"finish-status":"success"}},[i("el-step",{attrs:{title:"填写信息",description:"签署合同"}}),i("el-step",{attrs:{title:"完成创建",description:"创建成功"}})],1):t._e(),i("div",{staticClass:"step-content"},[i("div",{directives:[{name:"show",rawName:"v-show",value:0===t.active,expression:"active === 0"}]},[t.Bool?i("contractInfo",{ref:"contractInfo",attrs:{data:t.details,"is-edit":t.disabled,"with-modal":t.withModal},on:{callback:t.callback,syncPermitResp:t.syncPermitResp}}):t._e()],1),i("div",{directives:[{name:"show",rawName:"v-show",value:1===t.active,expression:"active === 1"}]}),i("div",{directives:[{name:"show",rawName:"v-show",value:2===t.active,expression:"active === 2"}]},[i("createComplete",{attrs:{"show-back":!1,"back-word":"查看合同","go-to-word":"再次创建",tips:"合同创建成功","handle-back":t.handleBack,recreate:t.Recreate}})],1)]),t.disabled&&!t.showSubmitBtn||"draft_edit"===t.withModal.type?t._e():i("div",{staticClass:"step-button"},[0===t.active?i("el-button",{attrs:{loading:t.submitLoading},on:{click:t.createContractDraft}},[t._v("保存为草稿")]):t._e(),0===t.active?i("el-button",{attrs:{type:"primary"},on:{click:t.handleCreate}},[t._v("创建")]):t._e()],1),"draft_edit"===t.withModal.type?i("div",{staticClass:"flex flex-row justify-center"},[i("el-button",{attrs:{type:"primary"},on:{click:t.editContractDraft}},[t._v("保存修改")]),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.handleCreate(!0)}}},[t._v("转为创建")])],1):t._e(),t.canyuShow?i("div",[t.showSubmitBtn||0!=t.state||t.showBtn?t._e():i("div",{staticClass:"action",staticStyle:{"text-align":"center"}},[i("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.handlePass(t.state)}}},[t._v("通过")]),i("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(e){return t.handleReject(t.state)}}},[t._v("驳回")]),t.permit_response&&void 0!==t.permit_response.project_id?i("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.toProjectDetail}},[t._v("Go项目脑图审批")]):t._e()],1)]):t._e()],1)])},r=[],n=a("5530"),o=a("c7eb"),s=a("1da1"),c=(a("e9c4"),a("b64b"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.formLoading,expression:"formLoading"}]},[a("el-card",{staticClass:"box-card",staticStyle:{"margin-top":"50px"},attrs:{shadow:"never","body-style":"padding: 0"}},[a("el-form",{ref:"administrative_contract_infoForm",staticClass:"demo-administrative_contract_infoForm",attrs:{model:t.administrative_contract_infoForm,rules:t.rules,"label-width":"100px","label-position":"left"}},[t.isEdit?a("el-form-item",{attrs:{label:"合同编号"}},[a("el-input",{attrs:{title:t.administrative_contract_infoForm.contract_code,disabled:t.isEdit},model:{value:t.administrative_contract_infoForm.contract_code,callback:function(e){t.$set(t.administrative_contract_infoForm,"contract_code",e)},expression:"administrative_contract_infoForm.contract_code"}})],1):t._e(),a("el-form-item",{attrs:{label:"合同类型"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{disabled:t.isEdit||0==t.adminFlag},model:{value:t.administrative_contract_infoForm.type,callback:function(e){t.$set(t.administrative_contract_infoForm,"type",e)},expression:"administrative_contract_infoForm.type"}},[0==t.adminFlag?a("el-option",{key:1,attrs:{label:"adminFlag",value:0}}):t._e(),a("el-option",{key:2,attrs:{label:"服务合同",value:1}}),a("el-option",{key:3,attrs:{label:"货物合同",value:2}}),a("el-option",{key:4,attrs:{label:"工程合同",value:3}}),a("el-option",{key:4,attrs:{label:"劳务合同",value:4}})],1)],1),a("el-form-item",{attrs:{label:"税率",prop:"tariff",required:""}},[a("el-select",{staticStyle:{width:"100%"},attrs:{disabled:t.isEdit},model:{value:t.administrative_contract_infoForm.tariff,callback:function(e){t.$set(t.administrative_contract_infoForm,"tariff",e)},expression:"administrative_contract_infoForm.tariff"}},[a("el-option",{attrs:{label:"0%",value:0}}),a("el-option",{attrs:{label:"1%",value:1}}),a("el-option",{attrs:{label:"3%",value:3}}),a("el-option",{attrs:{label:"6%",value:6}}),a("el-option",{attrs:{label:"9%",value:9}}),a("el-option",{attrs:{label:"13%",value:13}})],1)],1),a("el-form-item",{attrs:{label:"甲方公司",prop:"contract_party_a_company_id"}},[a("TypeSearch",{attrs:{disabled:t.isEdit||t.detailToCreate,type:"company"},model:{value:t.administrative_contract_infoForm.contract_party_a_company_id,callback:function(e){t.$set(t.administrative_contract_infoForm,"contract_party_a_company_id",e)},expression:"administrative_contract_infoForm.contract_party_a_company_id"}})],1),a("el-form-item",{attrs:{label:"乙方公司",prop:"contract_party_b_company_id"}},[a("TypeSearch",{attrs:{disabled:t.isEdit,type:"company"},model:{value:t.administrative_contract_infoForm.contract_party_b_company_id,callback:function(e){t.$set(t.administrative_contract_infoForm,"contract_party_b_company_id",e)},expression:"administrative_contract_infoForm.contract_party_b_company_id"}})],1),a("el-form-item",{attrs:{label:"合同名称",required:"",prop:"contract_name"}},[a("el-input",{attrs:{title:t.administrative_contract_infoForm.contract_name,disabled:t.isEdit,placeholder:"请输入合同名称"},model:{value:t.administrative_contract_infoForm.contract_name,callback:function(e){t.$set(t.administrative_contract_infoForm,"contract_name",e)},expression:"administrative_contract_infoForm.contract_name"}})],1),a("el-form-item",{attrs:{label:"合同金额",required:"",prop:"contract_money"}},[a("el-input",{attrs:{title:t.administrative_contract_infoForm.contract_money,disabled:t.isEdit,placeholder:"请输入合同金额"},model:{value:t.administrative_contract_infoForm.contract_money,callback:function(e){t.$set(t.administrative_contract_infoForm,"contract_money",e)},expression:"administrative_contract_infoForm.contract_money"}})],1),a("el-form-item",{attrs:{label:"合同约定事宜"}},[a("el-input",{attrs:{title:t.administrative_contract_infoForm.remarks,disabled:t.isEdit,placeholder:"请输入合同约定事宜"},model:{value:t.administrative_contract_infoForm.remarks,callback:function(e){t.$set(t.administrative_contract_infoForm,"remarks",e)},expression:"administrative_contract_infoForm.remarks"}})],1),a("el-form-item",{attrs:{label:"电子合同",prop:"electronic"}},[a("el-upload",{staticClass:"upload-demo",attrs:{action:"##",disabled:t.isEdit,"file-list":t.fileList,"before-upload":t.beforUpload,"on-remove":t.handleRemove,"before-remove":t.beforeRemove,"on-preview":t.handleDown}},[a("el-button",{attrs:{size:"small",type:"primary",disabled:t.isEdit}},[t._v("点击上传")])],1)],1),0!=t.adminFlag?a("div",[a("el-form-item",{attrs:{label:"是否归属项目",prop:"is_project",required:""}},[a("el-select",{staticStyle:{width:"100%"},attrs:{disabled:t.isEdit||t.detailToCreate},model:{value:t.administrative_contract_infoForm.is_project,callback:function(e){t.$set(t.administrative_contract_infoForm,"is_project",e)},expression:"administrative_contract_infoForm.is_project"}},[a("el-option",{attrs:{label:"归属",value:1}}),a("el-option",{attrs:{label:"不归属",value:0}})],1)],1),t.administrative_contract_infoForm.is_project?a("el-form-item",{attrs:{label:"项目",prop:"project_id"}},[a("TypeSearch",{attrs:{disabled:t.isEdit||t.detailToCreate,type:"project"},model:{value:t.administrative_contract_infoForm.project_id,callback:function(e){t.$set(t.administrative_contract_infoForm,"project_id",e)},expression:"administrative_contract_infoForm.project_id"}})],1):t._e(),a("el-form-item",{attrs:{label:"是否主合同",prop:"is_main",required:""}},[a("el-select",{staticStyle:{width:"100%"},attrs:{disabled:t.isEdit||t.detailToCreate},model:{value:t.administrative_contract_infoForm.is_main,callback:function(e){t.$set(t.administrative_contract_infoForm,"is_main",e)},expression:"administrative_contract_infoForm.is_main"}},[a("el-option",{attrs:{label:"是",value:1}}),a("el-option",{attrs:{label:"否",value:0}})],1)],1),t.addBool?t._e():a("el-form-item",{attrs:{label:"是否会分包",prop:"is_subcontract",required:""}},[a("el-select",{staticStyle:{width:"100%"},attrs:{disabled:t.isEdit},model:{value:t.administrative_contract_infoForm.is_subcontract,callback:function(e){t.$set(t.administrative_contract_infoForm,"is_subcontract",e)},expression:"administrative_contract_infoForm.is_subcontract"}},[a("el-option",{attrs:{label:"是",value:1}}),a("el-option",{attrs:{label:"否",value:0}})],1)],1),a("el-form-item",{attrs:{label:"分包备注"}},[a("el-input",{attrs:{title:t.administrative_contract_infoForm.subcontract_remarks,disabled:t.isEdit,placeholder:"请输入"},model:{value:t.administrative_contract_infoForm.subcontract_remarks,callback:function(e){t.$set(t.administrative_contract_infoForm,"subcontract_remarks",e)},expression:"administrative_contract_infoForm.subcontract_remarks"}})],1),a("el-form-item",{attrs:{label:"关联合同",prop:"contract_pid"}},[a("TypeSearch",{attrs:{disabled:t.isEdit||t.detailToCreate,type:"contract"},model:{value:t.administrative_contract_infoForm.contract_pid,callback:function(e){t.$set(t.administrative_contract_infoForm,"contract_pid",e)},expression:"administrative_contract_infoForm.contract_pid"}})],1)],1):t._e()],1)],1)],1)}),l=[],d=(a("caad"),a("d81d"),a("b0c0"),a("d3b7"),a("25f0"),a("3ca3"),a("a573"),a("ddb0"),a("277f")),u=a("9437"),m=a("2f62"),p=a("429f"),f={components:{TypeSearch:function(){return a.e("chunk-2d0e19ad").then(a.bind(null,"7ac0"))}},props:["data","isEdit","withModal"],data:function(t){var e=this,a=t.data;"[object String]"===Object.prototype.toString.call(a.file)&&(a.file=a.file?JSON.parse(a.file):[]);var i=t.isEdit;return{formLoading:!1,addBool:!0,adminFlag:0,isAll:!1,isEdit:i,fileList:[],administrative_contract_infoForm:a&&a.type?a:{remarks:"",file:[],type:"",contract_party_a_company_id:"",contract_party_b_company_id:"",contract_name:"",contract_money:"",is_project:"",project_id:"",tariff:"",is_main:"",is_subcontract:"",contract_pid:"",subcontract_remarks:"",contract_code:""},rules:{type:[{required:!0,message:"请选择合同类型",trigger:"change"}],contract_party_a_company_id:[{required:!0,message:"请选择合同甲方公司",trigger:"change"}],contract_party_b_company_id:[{required:!0,message:"请选择合同乙方公司",trigger:"change"}],contract_name:[{required:!0,message:"请输入合同名称",trigger:"blur"}],contract_money:[{required:!0,message:"请输入合同金额",trigger:"blur"}],remarks:[{required:!0,message:"请输入合同约定事宜",trigger:"blur"}],subcontract_remarks:[{required:!0,message:"请输入分包备注",trigger:"blur"}],electronic:[{required:!0,validator:function(t,a,i){0===e.fileList.length?i(new Error("请上传电子合同")):i()}}],is_project:[{required:!0,message:"请选择是否归属项目",trigger:"change"}],project_id:[{required:!0,message:"请选择项目",trigger:"change"}],tariff:[{required:!0,message:"请选择税率",trigger:"change"}],is_main:[{required:!0,message:"请选择是否主合同",trigger:"change"}],is_subcontract:[{required:!0,message:"请选择是否会分包",trigger:"change"}]},detailToCreate:!1}},watch:{fileList:{handler:function(t,e){t.length>0&&this.$refs.administrative_contract_infoForm.validateField("electronic")},deep:!0}},mounted:function(){var t=this;if(this.withModal){if(this.adminFlag=this.withModal.contractType,this.withModal.type){var e=this.withModal.type;switch(e){case"edit":this.fileList=this.administrative_contract_infoForm.file.map((function(e){return{url:e,name:t.getFileName(e)}}));break;case"audit":this.permitsGetInfoFun({id:this.withModal.permit_id});break;case"create":this.fileList=this.administrative_contract_infoForm.file.map((function(e){return{url:e,name:t.getFileName(e)}}));break;case"draft_edit":this.fileList=this.administrative_contract_infoForm.file.map((function(e){return{url:e,name:t.getFileName(e)}}));break;default:break}}}else this.$route.query.addBool&&(this.addBool=!0),this.$route.query.typeData?("true"===this.$route.query.permitType?this.adminFlag=0:this.adminFlag=1,this.permitsGetInfoFun({id:this.$route.query.id})):("0"===this.$route.query.type?this.adminFlag=0:this.adminFlag=1,this.fileList=this.administrative_contract_infoForm.file.map((function(e){return{url:e,name:t.getFileName(e)}}))),this.$route.query.qianshu&&(this.administrative_contract_infoForm.type=""),this.$route.query.detailToCreate&&(this.detailToCreate=this.$route.query.detailToCreate)},methods:Object(n["a"])(Object(n["a"])({},Object(m["c"])("app",["OPEN_PREVIEW"])),{},{handleDown:function(t){var e,a=t.name.split(".").pop();["pdf"].includes(a)&&(e="pdf"),["doc","docx"].includes(a)&&(e="doc"),["png","jpg","jpeg","gif","bmp"].includes(a)&&(e="pic"),this.OPEN_PREVIEW({url:t.url,type:e})},permitsGetInfoFun:function(){var t=this;return Object(s["a"])(Object(o["a"])().mark((function e(){var a,i,r;return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.formLoading=!0,e.next=3,Object(d["z"])({id:t.withModal?t.withModal.permit_id:t.$route.query.id});case 3:if(a=e.sent,t.$emit("callback",a.data),"[object String]"===Object.prototype.toString.call(a.data.info.file)&&(i=a.data.info.file?JSON.parse(a.data.info.file):[],t.fileList=i.map((function(e){return{name:t.getFileName(e),url:e}}))),t.administrative_contract_infoForm=a.data.info,!a.data.project_id){e.next=12;break}return e.next=10,Object(p["e"])(a.data.project_id);case 10:r=e.sent,t.$emit("syncPermitResp",Object(n["a"])(Object(n["a"])({},a.data),{},{info:r.data[0]}));case 12:t.formLoading=!1;case 13:case"end":return e.stop()}}),e)})))()},getFormData:function(){var t=!1;if(this.$refs["administrative_contract_infoForm"].validate((function(e){t=e})),t)return Object(n["a"])(Object(n["a"])({},this.administrative_contract_infoForm),{},{file:JSON.stringify(this.fileList.map((function(t){return t.url})))})},resetForm:function(){this.$refs["administrative_contract_infoForm"].resetFields()},beforUpload:function(t){var e=this,a=new FormData;return a.append("files",t),Object(u["a"])(a).then((function(a){200===a.code&&(t.url=a.data.file,e.fileList.push(t))})),!1},handleRemove:function(t,e){this.fileList=e},beforeRemove:function(){if(this.isEdit)return!1},getFileName:function(t){return-1!==t.lastIndexOf("?")?decodeURIComponent(t.substring(t.lastIndexOf("/")+1,t.lastIndexOf("?"))):decodeURIComponent(t.substring(t.lastIndexOf("/")+1))}})},h=f,_=(a("b65c"),a("2877")),b=Object(_["a"])(h,c,l,!1,null,"3ddcfb2e",null),v=b.exports,y=a("ba84"),g=a("35ad"),w=a("ed08"),j=a("5c96"),k={components:{contractInfo:v,createComplete:y["a"]},props:{withModal:{type:Object,default:void 0}},data:function(){return{state_name:"",permit_type_name:"",showIsTop:!1,istop:!1,canyuShow:!0,isAll:!1,active:0,FirstStepData:{},extendInfoData:{},contractInfoData:{},details:{},Bool:!1,disabled:!1,showSubmitBtn:!0,state:"",showBtn:!1,submitLoading:!1,permit_response:void 0}},mounted:function(){var t,e,a,i;if(this.withModal){if(this.state_name=null===(t=this.withModal.permit_row)||void 0===t?void 0:t.state_name,this.permit_type_name=null===(e=this.withModal.permit_row)||void 0===e?void 0:e.permit_type_name,this.istop=null===(a=this.withModal.permit_row)||void 0===a?void 0:a.isTop,this.showIsTop=0===(null===(i=this.withModal.permit_row)||void 0===i?void 0:i.state),this.withModal.hide_permit_btn&&(this.canyuShow=!1),this.withModal.type)switch(this.withModal.type){case"edit":this.showBtn=!0,this.showSubmitBtn=!1,this.withModal.id?(this.disabled=!0,this.getDeatils(this.withModal.id)):this.Bool=!0;break;case"audit":this.showSubmitBtn=!1,this.disabled=!0,this.Bool=!0;break;case"create":this.Bool=!0;break;case"draft_edit":this.disabled=!1,this.showSubmitBtn=!1,this.getDraftDetail(this.withModal.id);break;default:break}}else this.state_name=this.$route.query.state_name,this.permit_type_name=this.$route.query.permit_type_name,this.istop="1"===this.$route.query.isTop,this.showIsTop="0"===this.$route.query.state,this.$route.query.canyuShow||void 0===this.$route.query.canyuShow||(this.canyuShow=this.$route.query.canyuShow),this.$route.query.qianshu&&(this.showSubmitBtn=!0,this.details=Object.assign({remarks:"",file:[],type:4,contract_party_a_company_id:"",contract_party_b_company_id:"",contract_name:"",contract_money:"",is_project:"",project_id:"",tariff:"",is_main:"",is_subcontract:"",contract_pid:"",subcontract_remarks:""},JSON.parse(this.$route.query.qianshu)),console.log("this.details",this.details)),this.$route.query.isEdit&&(this.showSubmitBtn=!0),this.$route.query.showBtn&&(this.showSubmitBtn=!1,this.showBtn=!0),this.$route.query.typeData?(this.showSubmitBtn=!1,this.disabled=!0,this.Bool=!0):this.$route.query.id?(this.disabled=!0,this.getDeatils(this.$route.query.id)):this.Bool=!0},methods:{toProjectDetail:function(){var t=this,e=t.permit_response.info;"未签约"===e.main_contract_id?Object(w["c"])(this,"NewProject",{data:JSON.stringify(e),type:"edit",isTop:e.istop}):Object(w["c"])(this,"projectDetail",{id:e.id,isTop:e.istop})},syncPermitResp:function(t){this.permit_response=t},handleTop:function(t){var e=this;return Object(s["a"])(Object(o["a"])().mark((function t(){var a;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(d["a"])({id:e.withModal?e.withModal.permit_id:e.$route.query.id});case 2:a=t.sent,200===a.code&&(e.$message.success(a.msg),e.istop=!e.istop);case 4:case"end":return t.stop()}}),t)})))()},handlePass:function(t){var e=this;return Object(s["a"])(Object(o["a"])().mark((function t(){var a;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(p["j"])({id:e.shenpi.id,type:"1"});case 2:a=t.sent,200===a.code&&(e.$message.success(a.msg),e.$router.push({name:"pendApprovalList"}));case 4:case"end":return t.stop()}}),t)})))()},handleReject:function(t){var e=this;return Object(s["a"])(Object(o["a"])().mark((function t(){var a;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(p["j"])({id:e.shenpi.id,type:"2"});case 2:a=t.sent,200===a.code&&(e.$message.success(a.msg),e.$router.push({name:"pendApprovalList"}));case 4:case"end":return t.stop()}}),t)})))()},callback:function(t){this.state=t.state,this.shenpi=t},getDeatils:function(t){var e=this;return Object(s["a"])(Object(o["a"])().mark((function a(){var i;return Object(o["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(g["c"])({id:t});case 2:i=a.sent,e.details=i.data,e.Bool=!0;case 5:case"end":return a.stop()}}),a)})))()},getDraftDetail:function(){var t=this;return Object(s["a"])(Object(o["a"])().mark((function e(){var a;return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.withModal.id){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,t.formLoading=!0,e.next=6,Object(g["g"])({id:t.withModal.id});case 6:a=e.sent,t.details=a.data,t.Bool=!0,e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](2),j["Message"].error(e.t0.msg);case 14:return e.prev=14,t.formLoading=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[2,11,14,17]])})))()},handleNext:function(){var t=this.$refs.contractInfo.getFormData();t&&(this.contractInfoData=t,this.active++)},handleCreate:function(){var t=arguments,e=this;return Object(s["a"])(Object(o["a"])().mark((function a(){var i,r,s,c;return Object(o["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(i=t.length>0&&void 0!==t[0]&&t[0],r=e.$refs.contractInfo.getFormData(),r){a.next=4;break}return a.abrupt("return");case 4:if("0"!==e.$route.query.type&&"create"!==e.withModal.type){a.next=16;break}return r.is_main=0,r.project_id=0,r.type=0,r.contract_pid=0,r.subcontract_remarks=0,a.next=12,Object(g["a"])(Object(n["a"])({},r));case 12:s=a.sent,200===s.code&&(e.active=2,e.$emit("refreshList"),e.$store.dispatch("company/updateAll","contract")),a.next=21;break;case 16:return console.log("contractInfoData",r),a.next=19,Object(g["a"])(Object(n["a"])({},r));case 19:c=a.sent,200===c.code&&(e.active=2,e.$emit("refreshList"),i?e.$emit("draftToCreate",e.withModal.id):e.$emit("refreshList"),e.$store.dispatch("company/updateAll","contract"));case 21:console.log("创建");case 22:case"end":return a.stop()}}),a)})))()},createContractDraft:function(){var t=this;return Object(s["a"])(Object(o["a"])().mark((function e(){var a,i;return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=t.$refs.contractInfo.getFormData(),a){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,t.submitLoading=!0,e.next=7,Object(g["b"])(a);case 7:i=e.sent,200===i.code&&t.$message({type:"success",message:i.msg||"已保存为草稿"}),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](3),j["Message"].error(e.t0.msg||"保存出错");case 14:return e.prev=14,t.submitLoading=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[3,11,14,17]])})))()},editContractDraft:function(){var t=this;return Object(s["a"])(Object(o["a"])().mark((function e(){var a,i;return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.withModal.data){e.next=2;break}return e.abrupt("return");case 2:if(a=t.$refs.contractInfo.getFormData(),a){e.next=5;break}return e.abrupt("return");case 5:return e.prev=5,t.submitLoading=!0,e.next=9,Object(g["b"])(Object(n["a"])(Object(n["a"])({},a),{},{id:t.withModal.data.id}));case 9:i=e.sent,200===i.code&&(t.$message({type:"success",message:i.msg||"修改成功"}),t.$emit("refreshList"),t.$emit("close")),e.next=16;break;case 13:e.prev=13,e.t0=e["catch"](5),j["Message"].error(e.t0.msg||"保存出错");case 16:return e.prev=16,t.submitLoading=!1,e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[5,13,16,19]])})))()},Recreate:function(){this.$refs.contractInfo.resetForm(),this.active=0},handleBack:function(){}}},F=k,O=(a("b29e"),Object(_["a"])(F,i,r,!1,null,"6923768c",null));e["default"]=O.exports},9437:function(t,e,a){"use strict";a.d(e,"a",(function(){return r}));var i=a("b775");function r(t){return Object(i["a"])({url:"Publics/upload",method:"post",data:t,headers:{"content-type":"multipart/form-data"}})}},"9a04":function(t,e,a){t.exports=a.p+"static/img/checking.73c367ae.png"},ac6f:function(t,e,a){t.exports=a.p+"static/img/refuted.d21e0353.png"},b29e:function(t,e,a){"use strict";a("bc75")},b65c:function(t,e,a){"use strict";a("227c")},bc75:function(t,e,a){},ed08:function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"a",(function(){return o})),a.d(e,"c",(function(){return s}));a("53ca"),a("d81d"),a("a434"),a("d3b7"),a("4d63"),a("ac1f"),a("2c3e"),a("00b4"),a("25f0"),a("4d90"),a("5319"),a("0643"),a("4e3e"),a("a573"),a("159b");var i=a("21a6"),r=a("25ca");a("bc3a"),a("aeb1");function n(t,e,a,n){var o=[],s=[],c=function(t){var e=0;for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&e++;return e};for(var l in t)if(console.log("------------------------"),Object.prototype.hasOwnProperty.call(t,l)){var d=t[l],u=[];for(var m in d)if(Object.prototype.hasOwnProperty.call(d,m)){var p=d[m];u.push(p),s.length<c(d)&&s.push(m)}o.push(u)}var f=[];a.map((function(t,e){"快速操作"!=t&&"详情"!=t&&f.push(t)})),o.splice(0,0,s,f),console.log("excel_data",r);var h=r["utils"].aoa_to_sheet(o),_=r["utils"].book_new(),b=[{hidden:!0}];h["!rows"]=b,r["utils"].book_append_sheet(_,h,n);var v=r["write"](_,{bookType:"xlsx",type:"array"}),y=new Blob([v],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});Object(i["saveAs"])(y,e+".xlsx")}function o(t){var e=-1!==t.lastIndexOf("?")?decodeURIComponent(t.substring(t.lastIndexOf("/")+1,t.lastIndexOf("?"))):decodeURIComponent(t.substring(t.lastIndexOf("/")+1)),a=e.substring(e.lastIndexOf(".")+1);if("png"==a||"jpg"==a||"pdf"==a){var r=document.createElement("a");r.href=t,r.download=e,r.target="_blank",r.click()}else fetch(t,{mode:"no-cors"}).then((function(t){return t.blob()})).then((function(t){console.log("blob",t),Object(i["saveAs"])(t,e)}))}function s(t,e,a){console.log("self",t);var i=t.$router.resolve({name:e,query:a}),r=window.open(i.href,e);r&&r.location.reload()}}}]);