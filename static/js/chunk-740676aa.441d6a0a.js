(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-740676aa","chunk-5b8f7470"],{"0993":function(t,e,a){t.exports=a.p+"static/img/checked.f8521b5f.png"},"1fbb":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main"},[a("searchComponent",{attrs:{"search-config":t.searchConfig},on:{search:t.handleSearch}}),a("div",{staticClass:"extend-action"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"small"},on:{click:t.add}},[t._v("新增")]),a("el-button",{attrs:{size:"small"},on:{click:t.batchExport}},[t._v("批量导出")]),a("el-button",{attrs:{type:"small"},on:{click:t.openDraft}},[t._v("草稿箱")])],1),a("customTable",{attrs:{columns:t.columns,"data-source":t.dataSource,total:t.total,height:"calc(100vh - 365px)",loading:t.loading},on:{selectChange:t.handleSelectChange,pageChange:t.handlePageChange},scopedSlots:t._u([{key:"action",fn:function(e){return[a("div",{staticClass:"action"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){return t.handleToDetail(e.data)}}},[t._v("详情")]),a("el-button",{staticStyle:{margin:"0"},attrs:{type:"primary",size:"small"},on:{click:function(a){return t.handleEdit(e.data)}}},[t._v("变更")]),a("el-popconfirm",{attrs:{title:"确定作废该条内容吗"},on:{onConfirm:function(a){return t.handleDelete(e.data)}}},[a("el-button",{attrs:{slot:"reference",type:"danger",size:"small"},slot:"reference"},[t._v("作废")])],1),a("el-button",{attrs:{type:"warning",size:"small"},on:{click:function(a){return t.handlePayMoney(e.data)}}},[t._v("付款")]),a("el-button",{staticStyle:{margin:"0"},attrs:{type:"success",size:"small"},on:{click:function(a){return t.handleInvoices(e.data)}}},[t._v("开票")])],1)]}},{key:"permitting_state_name",fn:function(e){return[a("el-tag",[t._v(t._s(e.data.permitting_state_name))])]}},{key:"detail",fn:function(e){return[a("el-link",{attrs:{type:"primary"},on:{click:function(a){return t.handleToDetail(e.data)}}},[t._v("查看")])]}}])}),a("el-dialog",{attrs:{title:"合同变更",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("detail-modal",{attrs:{height:"60vh"}},[a("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules}},[a("el-form-item",{attrs:{label:"合同名称",required:"",prop:"contract_name"}},[a("el-input",{attrs:{title:t.form.contract_name,placeholder:"请输入合同名称"},model:{value:t.form.contract_name,callback:function(e){t.$set(t.form,"contract_name",e)},expression:"form.contract_name"}})],1),a("el-form-item",{attrs:{label:"合同金额",required:"",prop:"contract_money"}},[a("el-input",{attrs:{title:t.form.contract_money,placeholder:"请输入合同金额"},model:{value:t.form.contract_money,callback:function(e){t.$set(t.form,"contract_money",e)},expression:"form.contract_money"}})],1),a("el-form-item",{attrs:{label:"合同税率",prop:"tariff",required:""}},[a("el-select",{staticStyle:{width:"100%"},model:{value:t.form.tariff,callback:function(e){t.$set(t.form,"tariff",e)},expression:"form.tariff"}},[a("el-option",{attrs:{label:"1%",value:1}}),a("el-option",{attrs:{label:"3%",value:3}}),a("el-option",{attrs:{label:"6%",value:6}}),a("el-option",{attrs:{label:"9%",value:9}}),a("el-option",{attrs:{label:"13%",value:13}})],1)],1),a("el-form-item",{attrs:{label:"本合同是否会分包",prop:"is_subcontract",required:""}},[a("el-select",{staticStyle:{width:"100%"},model:{value:t.form.is_subcontract,callback:function(e){t.$set(t.form,"is_subcontract",e)},expression:"form.is_subcontract"}},[a("el-option",{attrs:{label:"是",value:"1"}}),a("el-option",{attrs:{label:"否",value:"0"}})],1)],1),a("el-form-item",{attrs:{label:"分包详情"}},[a("el-input",{attrs:{title:t.form.subcontract_remarks,placeholder:"请输入分包详情"},model:{value:t.form.subcontract_remarks,callback:function(e){t.$set(t.form,"subcontract_remarks",e)},expression:"form.subcontract_remarks"}})],1),a("el-form-item",{attrs:{label:"合同约定事宜"}},[a("el-input",{attrs:{title:t.form.remarks,placeholder:"请输入合同约定事宜"},model:{value:t.form.remarks,callback:function(e){t.$set(t.form,"remarks",e)},expression:"form.remarks"}})],1),a("el-form-item",{attrs:{label:"电子合同",prop:"electronic"}},[a("el-upload",{staticClass:"upload-demo",attrs:{action:"##","file-list":t.fileList,"before-upload":t.beforUpload,"on-remove":t.handleRemove,"before-remove":t.beforeRemove,"on-preview":t.handleDown}},[a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")])],1)],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.handleCancel}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.handleComifm}},[t._v("确 定")])],1)],1),a("el-drawer",{attrs:{size:"75%",visible:t.showDetailModal,"destroy-on-close":!0},on:{"update:visible":function(e){t.showDetailModal=e},close:t.closeDrawer}},[a("detail-modal",[t.modalFreshControl?a("project-create",{attrs:{"with-modal":t.withModal},on:{refresh:t.modalRefresh,refreshList:t.refreshList,close:t.closeDrawer}}):t._e()],1)],1),a("el-dialog",{attrs:{visible:t.showDraft,width:"80%","destroy-on-close":!0},on:{"update:visible":function(e){t.showDraft=e},close:t.closeDraft}},[t.showDraft?a("project-contract-draft"):t._e()],1)],1)},i=[],n=a("c7eb"),s=a("5530"),o=a("1da1"),c=(a("caad"),a("d81d"),a("e9c4"),a("b64b"),a("2532"),a("a573"),a("878f")),l=a("6cff"),d=a("35ad"),u=a("c1df"),m=a.n(u),f=a("ed08"),p=a("9437"),h=a("1aac"),b=a("6962"),_=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main"},[a("customTable",{attrs:{columns:t.columns,"data-source":t.dataSource,total:t.total,loading:t.loading,height:"calc(100vh - 462px)"},on:{pageChange:t.handlePageChange},scopedSlots:t._u([{key:"action",fn:function(e){return[a("div",{staticClass:"action"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){return t.handleToDetail(e.data)}}},[t._v("详情")]),a("el-popconfirm",{attrs:{title:"确定删除该条内容吗"},on:{onConfirm:function(a){return t.handleDelete(e.data)}}},[a("el-button",{attrs:{slot:"reference",size:"small",type:"danger"},slot:"reference"},[t._v("删除")])],1)],1)]}}])}),a("el-drawer",{attrs:{visible:t.showDrawer,size:"65%","append-to-body":!0,"destroy-on-close":!0},on:{"update:visible":function(e){t.showDrawer=e},close:t.closeDrawer}},[a("detail-modal",[t.showDrawer?a("create-contract",{attrs:{"with-modal":t.withModal},on:{close:t.closeDrawer,draftToCreate:t.draftToCreate}}):t._e()],1)],1)],1)},v=[],g=a("5c96"),j={name:"ProjectContractDraft",components:{customTable:c["a"],createContract:b["default"],detailModal:h["a"]},data:function(){return{loading:!1,total:0,withModal:void 0,showDrawer:!1,columns:[{title:"合同编号",key:"contract_code",minWidth:"120"},{title:"是否主合同",key:"is_main"},{title:"合同名称",key:"contract_name",minWidth:"120"},{title:"合同类型",key:"type_name",minWidth:"120"},{title:"所属项目",key:"project_name",minWidth:"120"},{title:"甲方公司",key:"contract_party_a_company_name",minWidth:"120"},{title:"乙方公司",key:"contract_party_b_company_name",minWidth:"120"},{title:"合同金额",key:"contract_money",minWidth:"120"},{title:"快速操作",key:"action",fixed:"right",width:"340px",render:"action"}],dataSource:[],searchParams:{page:1,limit:10}}},mounted:function(){this.getList()},methods:{closeDrawer:function(){this.withModal=void 0,this.showDrawer=!1},getList:function(){var t=this;return Object(o["a"])(Object(n["a"])().mark((function e(){var a;return Object(n["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t.loading=!0,e.next=4,Object(d["h"])(t.searchParams);case 4:a=e.sent,200===a.code?t.dataSource=a.data:g["Message"].error(a.msg),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),g["Message"].error(e.t0.msg||"获取草稿箱出错");case 11:return e.prev=11,t.loading=!1,e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[0,8,11,14]])})))()},handleToDetail:function(t){this.withModal={id:t.id,data:t,is_permit:!1,hide_permit_btn:!0,contractType:0,type:"draft_edit"},this.showDrawer=!0},handleDelete:function(t){var e=this;return Object(o["a"])(Object(n["a"])().mark((function a(){var r;return Object(n["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,e.formLoading=!0,a.next=4,Object(d["d"])({id:t.id});case 4:r=a.sent,200===r.code?(g["Message"].success("已删除"),e.getList()):g["Message"].error(r.msg),a.next=11;break;case 8:a.prev=8,a.t0=a["catch"](0),g["Message"].error(a.t0.msg||"删除失败");case 11:return a.prev=11,e.formLoading=!1,a.finish(11);case 14:case"end":return a.stop()}}),a,null,[[0,8,11,14]])})))()},handlePageChange:function(t){this.searchParams=Object(s["a"])(Object(s["a"])({},this.searchParams),t),this.getList()},draftToCreate:function(t){var e=this;return Object(o["a"])(Object(n["a"])().mark((function a(){return Object(n["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,e.loading=!0,e.withModal=void 0,e.showDrawer=!1,a.next=6,Object(d["d"])({id:t});case 6:e.getList(),a.next=12;break;case 9:a.prev=9,a.t0=a["catch"](0),g["Message"].error(a.t0.msg);case 12:return a.prev=12,e.loading=!1,a.finish(12);case 15:case"end":return a.stop()}}),a,null,[[0,9,12,15]])})))()}}},y=j,w=(a("b98c"),a("2877")),k=Object(w["a"])(y,_,v,!1,null,"0f86200d",null),O=k.exports,x={components:{customTable:c["a"],searchComponent:l["a"],detailModal:h["a"],projectCreate:b["default"],ProjectContractDraft:O},data:function(){var t=this;return{showDraft:!1,showDetailModal:!1,modalFreshControl:!0,withModal:void 0,columns:[{title:"合同编号",key:"contract_code",minWidth:"120"},{title:"创建人",key:"create_name",minWidth:"120"},{title:"合同概要",key:"remarks",minWidth:"120"},{title:"甲方公司",key:"contract_party_a_company_name",minWidth:"120"},{title:"乙方公司",key:"contract_party_b_company_name",minWidth:"120"},{title:"合同金额",key:"contract_money",minWidth:"120"},{title:"签订时间",key:"create_time",minWidth:"120"},{title:"审批状态",key:"permitting_state_name",minWidth:"120",render:"permitting_state_name"},{title:"快速操作",key:"action",fixed:"right",width:"340px",render:"action"}],dataSource:[],selectArr:[],searchConfig:{formItemLength:5,span:6,labelWidth:"80px",formItem:[{label:"合同编号",value:"contract_code",type:"input",placeholder:"请输入合同编号"},{label:"甲方公司",value:"contract_party_a_company_id",type:"company",placeholder:"请输入甲方公司"},{label:"乙方公司",value:"contract_party_b_company_id",type:"company",placeholder:"请输入人员编号"},{label:"审批状态",value:"permitting_state",type:"select",options:[{value:"1",label:"已审批"},{value:"2",label:"已驳回"},{value:"3",label:"待审批"}]},{label:"签订时间",value:"time",type:"dateRange"},{label:"金额区间",value:["contract_money_min","contract_money_max"],type:"amount"}]},searchParams:{page:1,limit:10},loading:!1,total:0,dialogFormVisible:!1,form:{contract_money:"",contract_name:"",tariff:"",is_subcontract:"",subcontract_remarks:"",remarks:""},rules:{contract_money:[{required:!0,message:"请输入合同金额",trigger:"change"}],contract_name:[{required:!0,message:"请输入合同名称",trigger:"blur"}],tariff:[{required:!0,message:"请选择合同税率",trigger:"change"}],is_subcontract:[{required:!0,message:"请选择是否分包",trigger:"change"}],subcontract_remarks:[{required:!0,message:"请输入分包详情",trigger:"blur"}],remarks:[{required:!0,message:"请输入合同约定事宜",trigger:"blur"}],electronic:[{required:!0,validator:function(e,a,r){0===t.fileList.length?r(new Error("请上传电子合同")):r()}}]},currentRow:{},fileList:[]}},watch:{fileList:{handler:function(t,e){t.length>0&&this.$refs.form.validateField("electronic")},deep:!0}},mounted:function(){var t=this;this.getDataSource(),this.fileList=this.administrative_contract_infoForm.file.map((function(e){return{url:e,name:t.getFileName(e)}}))},methods:{openDraft:function(){this.showDraft=!0},closeDraft:function(){this.showDraft=!1},closeDrawer:function(){this.showDetailModal=!1,this.refreshList()},refreshList:function(){this.getDataSource()},modalRefresh:function(){var t=this;this.modalFreshControl=!1,this.$nextTick((function(){t.modalFreshControl=!0}))},handleDown:function(t){Object(f["a"])(t.url)},batchExport:function(){var t=this;return Object(o["a"])(Object(n["a"])().mark((function e(){var a,r,i;return Object(n["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(d["f"])(Object(s["a"])({page:1,limit:1e6},t.searchParams));case 2:a=e.sent,r=t.columns.map((function(t){return t.key})),i=[],a.data.map((function(t){var e={};r.map((function(a){e[a]=t[a]})),i.push(e)})),Object(f["b"])(i,t.$route.meta.title,t.columns.map((function(t){return t.title})),t.$route.meta.title);case 7:case"end":return e.stop()}}),e)})))()},selectChange:function(){},handleSelectChange:function(){},handlePayMoney:function(t){this.paymentsInfoFun(t)},paymentsInfoFun:function(t){var e=this;return Object(o["a"])(Object(n["a"])().mark((function a(){return Object(n["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:e.$router.push({path:"/fund_account_management/transfer_create",query:{data:JSON.stringify(t),type:0}});case 1:case"end":return a.stop()}}),a)})))()},handleInvoices:function(t){this.$router.push({path:"/invoices-management/openInvoices",query:{data:JSON.stringify(t),isAdmin:!1}})},handleEdit:function(t){var e=this;return Object(o["a"])(Object(n["a"])().mark((function a(){var r;return Object(n["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.currentRow=t,e.dialogFormVisible=!0,console.log("row",t),a.next=5,Object(d["c"])({id:t.id});case 5:r=a.sent,e.form=r.data,e.fileList=r.data.file?JSON.parse(r.data.file).map((function(t){return{url:t,name:e.getFileName(t)}})):[];case 8:case"end":return a.stop()}}),a)})))()},handleDelete:function(t){var e=this;Object(d["e"])({id:t.id}).then((function(t){200===t.code&&(e.$message({type:"success",message:"删除成功"}),e.getDataSource())}))},handleToDetail:function(t){this.showDetailModal=!0,this.withModal={id:t.id,data:t,is_permit:!1,contractType:0,type:"edit"}},handlePageChange:function(t){this.searchParams=Object(s["a"])(Object(s["a"])({},this.searchParams),t),this.getDataSource()},handleSearch:function(t){this.searchParams=Object(s["a"])(Object(s["a"])({},this.searchParams),t),t.time?this.searchParams=Object(s["a"])(Object(s["a"])({},this.searchParams),{},{start_time:m()(t.time[0]).format("YYYY-MM-DD HH:mm:ss"),end_time:m()(t.time[1]).format("YYYY-MM-DD HH:mm:ss")}):this.searchParams=Object(s["a"])(Object(s["a"])({},this.searchParams),{},{start_time:"",end_time:""}),this.getDataSource()},add:function(){this.withModal={type:"create"},this.showDetailModal=!0},getDataSource:function(){var t=this;return Object(o["a"])(Object(n["a"])().mark((function e(){var a;return Object(n["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loading=!0,e.next=3,Object(d["f"])(t.searchParams);case 3:a=e.sent,t.loading=!1,t.total=a.count,t.dataSource=a.data;case 7:case"end":return e.stop()}}),e)})))()},handleCancel:function(){this.$refs.form.resetFields(),this.dialogFormVisible=!1},handleComifm:function(){var t=this,e=this;this.$refs.form.validate((function(a){if(a){var r=Object(s["a"])(Object(s["a"])({},e.form),{},{id:e.currentRow.id,file:t.fileList.length>0?JSON.stringify(t.fileList.map((function(t){return t.url}))):"[]",contract_money:t.form.contract_money.includes("¥")?t.form.contract_money.split("¥")[1]:t.form.contract_money});Object(d["j"])(r).then((function(a){200===a.code&&(e.$message({type:"success",message:"操作成功"}),e.getDataSource(),e.dialogFormVisible=!1,t.$store.dispatch("company/updateAll","contract"))}))}}))},beforUpload:function(t){var e=this,a=new FormData;return a.append("files",t),Object(p["a"])(a).then((function(a){200===a.code&&(t.url=a.data.file,e.fileList.push(t))})),!1},handleRemove:function(t,e){this.fileList=e},beforeRemove:function(){},getFileName:function(t){return-1!==t.lastIndexOf("?")?decodeURIComponent(t.substring(t.lastIndexOf("/")+1,t.lastIndexOf("?"))):decodeURIComponent(t.substring(t.lastIndexOf("/")+1))}}},F=x,D=(a("8f1a"),Object(w["a"])(F,r,i,!1,null,"6b4f8a6b",null));e["default"]=D.exports},"227c":function(t,e,a){},"35ad":function(t,e,a){"use strict";a.d(e,"c",(function(){return i})),a.d(e,"a",(function(){return n})),a.d(e,"j",(function(){return s})),a.d(e,"e",(function(){return o})),a.d(e,"i",(function(){return c})),a.d(e,"f",(function(){return l})),a.d(e,"h",(function(){return d})),a.d(e,"b",(function(){return u})),a.d(e,"g",(function(){return m})),a.d(e,"d",(function(){return f}));var r=a("b775");function i(t){return Object(r["a"])({url:"/Contracts/info?id=".concat(t.id),method:"post",data:t})}function n(t){return Object(r["a"])({url:"/Contracts/add",method:"post",data:t})}function s(t){return Object(r["a"])({url:"/Contracts/update",method:"post",data:t})}function o(t){return Object(r["a"])({url:"/Contracts/delete",method:"post",data:t})}function c(t){return Object(r["a"])({url:"/Contracts/getProjectList",method:"post",data:t})}function l(t){return Object(r["a"])({url:"/Contracts/getAdministrativeList",method:"post",data:t})}function d(t){return Object(r["a"])({url:"/Contracts/getDraftList",method:"post",data:t})}function u(t){return Object(r["a"])({url:t.id?"/Contracts/editDraft":"/Contracts/draftAdd",method:"post",data:t})}function m(t){return Object(r["a"])({url:"/Contracts/draftInfo?id=".concat(t.id),method:"post",data:t})}function f(t){return Object(r["a"])({url:"/Contracts/delDraft",method:"post",data:t})}},3841:function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"g",(function(){return n})),a.d(e,"e",(function(){return s})),a.d(e,"c",(function(){return o})),a.d(e,"f",(function(){return c})),a.d(e,"d",(function(){return l})),a.d(e,"a",(function(){return d}));var r=a("b775");function i(t){return Object(r["a"])({url:"/Staffs/add",method:"post",data:t})}function n(t){return Object(r["a"])({url:"/Staffs/update",method:"post",data:t})}function s(t){return Object(r["a"])({url:"/Staffs/getInfo",method:"post",data:t})}function o(t){return Object(r["a"])({url:"/Staffs/delete",method:"post",data:t})}function c(t){return Object(r["a"])({url:"/Staffs/getList",method:"post",data:t})}function l(t){return Object(r["a"])({url:"/Publics/getArea",method:"post",data:t})}function d(t){return Object(r["a"])({url:"/Payments/deleteStaffBank",method:"post",data:t})}},4678:function(t,e,a){var r={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-ps":"4c98","./ar-ps.js":"4c98","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn-bd":"9686","./bn-bd.js":"9686","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-mx":"b5b7","./es-mx.js":"b5b7","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df48","./fa.js":"8df48","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b46","./gd.js":"f6b46","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku-kmr":"7558","./ku-kmr.js":"7558","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e9","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e9","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function i(t){var e=n(t);return a(e)}function n(t){if(!a.o(r,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return r[t]}i.keys=function(){return Object.keys(r)},i.resolve=n,t.exports=i,i.id="4678"},6582:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAABAFJREFUaEPdWs9PE0EU/qYUo4IhGqDYgxBjBDXBRCV6MSb8AXrzZk0MxIM/DuoBDmgU6Qk9iB4sJ/Hm0cSjJqgHUPFHlLT4G6NNWwoIFKyF7jMz7eK23XZ3u93WuqemO/Pm+958896bmWUowOOnmS0VWD5EYG0A7QJYE4B6AFVJ84sAQgB9Bdg4Az2Po3LYyTZ9Mzs8y9eAn/y1Fah0EaSjANufnx0aZbDdi2N5yMmc4XxsGCbAvW3DygUApwEY7p8FJAG4KcHeb3RWDAEI0lQPgS4XEHg6H2JglxysrlfvbOgi4KepvTZIt/KXil44cjsalWA75WR1Y1o9NQkEKXiMwO5Y6PVsGImBjjuY424uEjkJBGnqHIGuaXnByvcM7LyD1V3PNkZWAv8CeBl0LhKqBJKyGbLSs0ZtM5BLTU4ZBBILlp6XQPNanEgCa0tf2BkEAhQcKV600cKcEWVHG5jjgPLfFALJOH/FqNlitmdgF5V5YpVAMsN+/QelkzENEuxNcsZeJRCg0A0AZ4rpTeVYQ9/u48jmdtRUVuuBMNDA6s/yhoIAL8xssIdK4X2JJFz1efAkPIbGKid6Wk6icb1TiwRJWKnnBaAgUKqYvyytwD3hwdPwq1XAeknIuUEQKEXk+R2PCc+PzLzJ8Pbummb0t/KCN9dDIiKx5OKd1JqzQr5fikfR5/Pg2cxbVbP6CAAS7I2s2Fk3El9Cn9eDF7PjquD1SiixgMnFihl95pYjQvMvZ72mwScNDLAABR8CrF2vRKZjc3gQGIZry2G9XUS72dg83BODeP3TVyjwAOgRn4FPALbqQTO55Eev7zYmF/04WLsH3c2dqLTZNbtOx37iqteDd/MfCghemPrMCSwA0MweSvAyigObWtHV0oGqinVZSYSi08Lz4/PcT5mPEc2rdI9wApKeBNbrvY3H4RcZNvZt3Imu5k7VDBqIhkW08S18sQI8t0mmCXArrTXb0d3Sgdo1G1eB/oiG4PYO4n2El1cF97xsUBDIW0JKWDs2bBVycq6tw/dfAfT5BvExon5uZVI2ymGFhPJaxGpe3VbdiK7mE3D7BvF58buVnpdt80VsLIyqLWYlUu5dHqUslI3CdCKMGi6jtUgUB7wYZSDvUsIIiQJqPsU3opQwU8zpIWEVeM5EFHP8h5lyOhcJK8EDyXKaEzC7oVEjYS14XokmTuwKtqVUkrAaPM/AKVvKhIyMR6P0aCNXqgY256rhVsefqZt63qHsj1WSa4FfYJTnwZY8bWYiko6pN9kkEXmURv6/w92ElMStTHker8vTYzY3mNRKWsmQ/Zbm/71i+jsTZXzJJ5Mo62tWpRjL9qJbSaKsPzVIJVKmH3uohcdSfm7zBx1kT++F89WDAAAAAElFTkSuQmCC"},"68fc":function(t,e,a){},6962:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"main"},[t.showSubmitBtn?t._e():r("div",{staticStyle:{position:"absolute",top:"50px",right:"300px","z-index":"10"}},["已审批"==t.state_name?r("img",{staticStyle:{display:"block",width:"150px"},attrs:{src:a("0993"),alt:""}}):t._e(),"审批中"==t.state_name?r("img",{staticStyle:{display:"block",width:"150px"},attrs:{src:a("9a04"),alt:""}}):t._e(),"已驳回"==t.state_name?r("img",{staticStyle:{display:"block",width:"150px"},attrs:{src:a("ac6f"),alt:""}}):t._e()]),t.showSubmitBtn?r("h3",{staticClass:"main-title",staticStyle:{display:"flex"}},[t._v(t._s(t.disabled?"详情":"签署合同")+" "),r("div",[t.permit_type_name?r("span",{staticStyle:{"padding-left":"20px",color:"#666666"}},[t._v("审批事项："+t._s(t.permit_type_name))]):t._e(),t.showIsTop?r("el-button",{staticStyle:{"margin-left":"50px"},attrs:{size:"small",type:"primary"},on:{click:t.handleTop}},[t._v(t._s(t.istop?"取消置顶":"置顶主页"))]):t._e()],1)]):t._e(),t.showSubmitBtn?t._e():r("h3",{staticClass:"main-title",staticStyle:{display:"flex","align-items":"center"}},[t._v("详情 "),r("div",[t.showIsTop?r("el-button",{staticStyle:{"margin-left":"50px"},attrs:{size:"small",type:"primary"},on:{click:t.handleTop}},[t._v(t._s(t.istop?"取消置顶":"置顶主页"))]):t._e()],1)]),r("div",{staticClass:"main-step"},[!t.disabled||t.showSubmitBtn?r("el-steps",{attrs:{active:t.active,"finish-status":"success"}},[r("el-step",{attrs:{title:"填写信息",description:"签署合同"}}),r("el-step",{attrs:{title:"完成创建",description:"创建成功"}})],1):t._e(),r("div",{staticClass:"step-content"},[r("div",{directives:[{name:"show",rawName:"v-show",value:0===t.active,expression:"active === 0"}]},[t.Bool?r("contractInfo",{ref:"contractInfo",attrs:{data:t.details,"is-edit":t.disabled,"with-modal":t.withModal},on:{callback:t.callback,syncPermitResp:t.syncPermitResp}}):t._e()],1),r("div",{directives:[{name:"show",rawName:"v-show",value:1===t.active,expression:"active === 1"}]}),r("div",{directives:[{name:"show",rawName:"v-show",value:2===t.active,expression:"active === 2"}]},[r("createComplete",{attrs:{"show-back":!1,"back-word":"查看合同","go-to-word":"再次创建",tips:"合同创建成功","handle-back":t.handleBack,recreate:t.Recreate}})],1)]),t.disabled&&!t.showSubmitBtn||"draft_edit"===t.withModal.type?t._e():r("div",{staticClass:"step-button"},[0===t.active?r("el-button",{attrs:{loading:t.submitLoading},on:{click:t.createContractDraft}},[t._v("保存为草稿")]):t._e(),0===t.active?r("el-button",{attrs:{type:"primary"},on:{click:t.handleCreate}},[t._v("创建")]):t._e()],1),"draft_edit"===t.withModal.type?r("div",{staticClass:"flex flex-row justify-center"},[r("el-button",{attrs:{type:"primary"},on:{click:t.editContractDraft}},[t._v("保存修改")]),r("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.handleCreate(!0)}}},[t._v("转为创建")])],1):t._e(),t.canyuShow?r("div",[t.showSubmitBtn||0!=t.state||t.showBtn?t._e():r("div",{staticClass:"action",staticStyle:{"text-align":"center"}},[r("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.handlePass(t.state)}}},[t._v("通过")]),r("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(e){return t.handleReject(t.state)}}},[t._v("驳回")]),t.permit_response&&void 0!==t.permit_response.project_id?r("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.toProjectDetail}},[t._v("Go项目脑图审批")]):t._e()],1)]):t._e()],1)])},i=[],n=a("5530"),s=a("c7eb"),o=a("1da1"),c=(a("e9c4"),a("b64b"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.formLoading,expression:"formLoading"}]},[a("el-card",{staticClass:"box-card",staticStyle:{"margin-top":"50px"},attrs:{shadow:"never","body-style":"padding: 0"}},[a("el-form",{ref:"administrative_contract_infoForm",staticClass:"demo-administrative_contract_infoForm",attrs:{model:t.administrative_contract_infoForm,rules:t.rules,"label-width":"100px","label-position":"left"}},[t.isEdit?a("el-form-item",{attrs:{label:"合同编号"}},[a("el-input",{attrs:{title:t.administrative_contract_infoForm.contract_code,disabled:t.isEdit},model:{value:t.administrative_contract_infoForm.contract_code,callback:function(e){t.$set(t.administrative_contract_infoForm,"contract_code",e)},expression:"administrative_contract_infoForm.contract_code"}})],1):t._e(),a("el-form-item",{attrs:{label:"合同类型"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{disabled:t.isEdit||0==t.adminFlag},model:{value:t.administrative_contract_infoForm.type,callback:function(e){t.$set(t.administrative_contract_infoForm,"type",e)},expression:"administrative_contract_infoForm.type"}},[0==t.adminFlag?a("el-option",{key:1,attrs:{label:"adminFlag",value:0}}):t._e(),a("el-option",{key:2,attrs:{label:"服务合同",value:1}}),a("el-option",{key:3,attrs:{label:"货物合同",value:2}}),a("el-option",{key:4,attrs:{label:"工程合同",value:3}}),a("el-option",{key:4,attrs:{label:"劳务合同",value:4}})],1)],1),a("el-form-item",{attrs:{label:"税率",prop:"tariff",required:""}},[a("el-select",{staticStyle:{width:"100%"},attrs:{disabled:t.isEdit},model:{value:t.administrative_contract_infoForm.tariff,callback:function(e){t.$set(t.administrative_contract_infoForm,"tariff",e)},expression:"administrative_contract_infoForm.tariff"}},[a("el-option",{attrs:{label:"0%",value:0}}),a("el-option",{attrs:{label:"1%",value:1}}),a("el-option",{attrs:{label:"3%",value:3}}),a("el-option",{attrs:{label:"6%",value:6}}),a("el-option",{attrs:{label:"9%",value:9}}),a("el-option",{attrs:{label:"13%",value:13}})],1)],1),a("el-form-item",{attrs:{label:"甲方公司",prop:"contract_party_a_company_id"}},[a("TypeSearch",{attrs:{disabled:t.isEdit||t.detailToCreate,type:"company"},model:{value:t.administrative_contract_infoForm.contract_party_a_company_id,callback:function(e){t.$set(t.administrative_contract_infoForm,"contract_party_a_company_id",e)},expression:"administrative_contract_infoForm.contract_party_a_company_id"}})],1),a("el-form-item",{attrs:{label:"乙方公司",prop:"contract_party_b_company_id"}},[a("TypeSearch",{attrs:{disabled:t.isEdit,type:"company"},model:{value:t.administrative_contract_infoForm.contract_party_b_company_id,callback:function(e){t.$set(t.administrative_contract_infoForm,"contract_party_b_company_id",e)},expression:"administrative_contract_infoForm.contract_party_b_company_id"}})],1),a("el-form-item",{attrs:{label:"合同名称",required:"",prop:"contract_name"}},[a("el-input",{attrs:{title:t.administrative_contract_infoForm.contract_name,disabled:t.isEdit,placeholder:"请输入合同名称"},model:{value:t.administrative_contract_infoForm.contract_name,callback:function(e){t.$set(t.administrative_contract_infoForm,"contract_name",e)},expression:"administrative_contract_infoForm.contract_name"}})],1),a("el-form-item",{attrs:{label:"合同金额",required:"",prop:"contract_money"}},[a("el-input",{attrs:{title:t.administrative_contract_infoForm.contract_money,disabled:t.isEdit,placeholder:"请输入合同金额"},model:{value:t.administrative_contract_infoForm.contract_money,callback:function(e){t.$set(t.administrative_contract_infoForm,"contract_money",e)},expression:"administrative_contract_infoForm.contract_money"}})],1),a("el-form-item",{attrs:{label:"合同约定事宜"}},[a("el-input",{attrs:{title:t.administrative_contract_infoForm.remarks,disabled:t.isEdit,placeholder:"请输入合同约定事宜"},model:{value:t.administrative_contract_infoForm.remarks,callback:function(e){t.$set(t.administrative_contract_infoForm,"remarks",e)},expression:"administrative_contract_infoForm.remarks"}})],1),a("el-form-item",{attrs:{label:"电子合同",prop:"electronic"}},[a("el-upload",{staticClass:"upload-demo",attrs:{action:"##",disabled:t.isEdit,"file-list":t.fileList,"before-upload":t.beforUpload,"on-remove":t.handleRemove,"before-remove":t.beforeRemove,"on-preview":t.handleDown}},[a("el-button",{attrs:{size:"small",type:"primary",disabled:t.isEdit}},[t._v("点击上传")])],1)],1),0!=t.adminFlag?a("div",[a("el-form-item",{attrs:{label:"是否归属项目",prop:"is_project",required:""}},[a("el-select",{staticStyle:{width:"100%"},attrs:{disabled:t.isEdit||t.detailToCreate},model:{value:t.administrative_contract_infoForm.is_project,callback:function(e){t.$set(t.administrative_contract_infoForm,"is_project",e)},expression:"administrative_contract_infoForm.is_project"}},[a("el-option",{attrs:{label:"归属",value:1}}),a("el-option",{attrs:{label:"不归属",value:0}})],1)],1),t.administrative_contract_infoForm.is_project?a("el-form-item",{attrs:{label:"项目",prop:"project_id"}},[a("TypeSearch",{attrs:{disabled:t.isEdit||t.detailToCreate,type:"project"},model:{value:t.administrative_contract_infoForm.project_id,callback:function(e){t.$set(t.administrative_contract_infoForm,"project_id",e)},expression:"administrative_contract_infoForm.project_id"}})],1):t._e(),a("el-form-item",{attrs:{label:"是否主合同",prop:"is_main",required:""}},[a("el-select",{staticStyle:{width:"100%"},attrs:{disabled:t.isEdit||t.detailToCreate},model:{value:t.administrative_contract_infoForm.is_main,callback:function(e){t.$set(t.administrative_contract_infoForm,"is_main",e)},expression:"administrative_contract_infoForm.is_main"}},[a("el-option",{attrs:{label:"是",value:1}}),a("el-option",{attrs:{label:"否",value:0}})],1)],1),t.addBool?t._e():a("el-form-item",{attrs:{label:"是否会分包",prop:"is_subcontract",required:""}},[a("el-select",{staticStyle:{width:"100%"},attrs:{disabled:t.isEdit},model:{value:t.administrative_contract_infoForm.is_subcontract,callback:function(e){t.$set(t.administrative_contract_infoForm,"is_subcontract",e)},expression:"administrative_contract_infoForm.is_subcontract"}},[a("el-option",{attrs:{label:"是",value:1}}),a("el-option",{attrs:{label:"否",value:0}})],1)],1),a("el-form-item",{attrs:{label:"分包备注"}},[a("el-input",{attrs:{title:t.administrative_contract_infoForm.subcontract_remarks,disabled:t.isEdit,placeholder:"请输入"},model:{value:t.administrative_contract_infoForm.subcontract_remarks,callback:function(e){t.$set(t.administrative_contract_infoForm,"subcontract_remarks",e)},expression:"administrative_contract_infoForm.subcontract_remarks"}})],1),a("el-form-item",{attrs:{label:"关联合同",prop:"contract_pid"}},[a("TypeSearch",{attrs:{disabled:t.isEdit||t.detailToCreate,type:"contract"},model:{value:t.administrative_contract_infoForm.contract_pid,callback:function(e){t.$set(t.administrative_contract_infoForm,"contract_pid",e)},expression:"administrative_contract_infoForm.contract_pid"}})],1)],1):t._e()],1)],1)],1)}),l=[],d=(a("caad"),a("d81d"),a("b0c0"),a("d3b7"),a("25f0"),a("3ca3"),a("a573"),a("ddb0"),a("277f")),u=a("9437"),m=a("2f62"),f=a("429f"),p={components:{TypeSearch:function(){return a.e("chunk-2d0e19ad").then(a.bind(null,"7ac0"))}},props:["data","isEdit","withModal"],data:function(t){var e=this,a=t.data;"[object String]"===Object.prototype.toString.call(a.file)&&(a.file=a.file?JSON.parse(a.file):[]);var r=t.isEdit;return{formLoading:!1,addBool:!0,adminFlag:0,isAll:!1,isEdit:r,fileList:[],administrative_contract_infoForm:a&&a.type?a:{remarks:"",file:[],type:"",contract_party_a_company_id:"",contract_party_b_company_id:"",contract_name:"",contract_money:"",is_project:"",project_id:"",tariff:"",is_main:"",is_subcontract:"",contract_pid:"",subcontract_remarks:"",contract_code:""},rules:{type:[{required:!0,message:"请选择合同类型",trigger:"change"}],contract_party_a_company_id:[{required:!0,message:"请选择合同甲方公司",trigger:"change"}],contract_party_b_company_id:[{required:!0,message:"请选择合同乙方公司",trigger:"change"}],contract_name:[{required:!0,message:"请输入合同名称",trigger:"blur"}],contract_money:[{required:!0,message:"请输入合同金额",trigger:"blur"}],remarks:[{required:!0,message:"请输入合同约定事宜",trigger:"blur"}],subcontract_remarks:[{required:!0,message:"请输入分包备注",trigger:"blur"}],electronic:[{required:!0,validator:function(t,a,r){0===e.fileList.length?r(new Error("请上传电子合同")):r()}}],is_project:[{required:!0,message:"请选择是否归属项目",trigger:"change"}],project_id:[{required:!0,message:"请选择项目",trigger:"change"}],tariff:[{required:!0,message:"请选择税率",trigger:"change"}],is_main:[{required:!0,message:"请选择是否主合同",trigger:"change"}],is_subcontract:[{required:!0,message:"请选择是否会分包",trigger:"change"}]},detailToCreate:!1}},watch:{fileList:{handler:function(t,e){t.length>0&&this.$refs.administrative_contract_infoForm.validateField("electronic")},deep:!0}},mounted:function(){var t=this;if(this.withModal){if(this.adminFlag=this.withModal.contractType,this.withModal.type){var e=this.withModal.type;switch(e){case"edit":this.fileList=this.administrative_contract_infoForm.file.map((function(e){return{url:e,name:t.getFileName(e)}}));break;case"audit":this.permitsGetInfoFun({id:this.withModal.permit_id});break;case"create":this.fileList=this.administrative_contract_infoForm.file.map((function(e){return{url:e,name:t.getFileName(e)}}));break;case"draft_edit":this.fileList=this.administrative_contract_infoForm.file.map((function(e){return{url:e,name:t.getFileName(e)}}));break;default:break}}}else this.$route.query.addBool&&(this.addBool=!0),this.$route.query.typeData?("true"===this.$route.query.permitType?this.adminFlag=0:this.adminFlag=1,this.permitsGetInfoFun({id:this.$route.query.id})):("0"===this.$route.query.type?this.adminFlag=0:this.adminFlag=1,this.fileList=this.administrative_contract_infoForm.file.map((function(e){return{url:e,name:t.getFileName(e)}}))),this.$route.query.qianshu&&(this.administrative_contract_infoForm.type=""),this.$route.query.detailToCreate&&(this.detailToCreate=this.$route.query.detailToCreate)},methods:Object(n["a"])(Object(n["a"])({},Object(m["c"])("app",["OPEN_PREVIEW"])),{},{handleDown:function(t){var e,a=t.name.split(".").pop();["pdf"].includes(a)&&(e="pdf"),["doc","docx"].includes(a)&&(e="doc"),["png","jpg","jpeg","gif","bmp"].includes(a)&&(e="pic"),this.OPEN_PREVIEW({url:t.url,type:e})},permitsGetInfoFun:function(){var t=this;return Object(o["a"])(Object(s["a"])().mark((function e(){var a,r,i;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.formLoading=!0,e.next=3,Object(d["z"])({id:t.withModal?t.withModal.permit_id:t.$route.query.id});case 3:if(a=e.sent,t.$emit("callback",a.data),"[object String]"===Object.prototype.toString.call(a.data.info.file)&&(r=a.data.info.file?JSON.parse(a.data.info.file):[],t.fileList=r.map((function(e){return{name:t.getFileName(e),url:e}}))),t.administrative_contract_infoForm=a.data.info,!a.data.project_id){e.next=12;break}return e.next=10,Object(f["e"])(a.data.project_id);case 10:i=e.sent,t.$emit("syncPermitResp",Object(n["a"])(Object(n["a"])({},a.data),{},{info:i.data[0]}));case 12:t.formLoading=!1;case 13:case"end":return e.stop()}}),e)})))()},getFormData:function(){var t=!1;if(this.$refs["administrative_contract_infoForm"].validate((function(e){t=e})),t)return Object(n["a"])(Object(n["a"])({},this.administrative_contract_infoForm),{},{file:JSON.stringify(this.fileList.map((function(t){return t.url})))})},resetForm:function(){this.$refs["administrative_contract_infoForm"].resetFields()},beforUpload:function(t){var e=this,a=new FormData;return a.append("files",t),Object(u["a"])(a).then((function(a){200===a.code&&(t.url=a.data.file,e.fileList.push(t))})),!1},handleRemove:function(t,e){this.fileList=e},beforeRemove:function(){if(this.isEdit)return!1},getFileName:function(t){return-1!==t.lastIndexOf("?")?decodeURIComponent(t.substring(t.lastIndexOf("/")+1,t.lastIndexOf("?"))):decodeURIComponent(t.substring(t.lastIndexOf("/")+1))}})},h=p,b=(a("b65c"),a("2877")),_=Object(b["a"])(h,c,l,!1,null,"3ddcfb2e",null),v=_.exports,g=a("ba84"),j=a("35ad"),y=a("ed08"),w=a("5c96"),k={components:{contractInfo:v,createComplete:g["a"]},props:{withModal:{type:Object,default:void 0}},data:function(){return{state_name:"",permit_type_name:"",showIsTop:!1,istop:!1,canyuShow:!0,isAll:!1,active:0,FirstStepData:{},extendInfoData:{},contractInfoData:{},details:{},Bool:!1,disabled:!1,showSubmitBtn:!0,state:"",showBtn:!1,submitLoading:!1,permit_response:void 0}},mounted:function(){var t,e,a,r;if(this.withModal){if(this.state_name=null===(t=this.withModal.permit_row)||void 0===t?void 0:t.state_name,this.permit_type_name=null===(e=this.withModal.permit_row)||void 0===e?void 0:e.permit_type_name,this.istop=null===(a=this.withModal.permit_row)||void 0===a?void 0:a.isTop,this.showIsTop=0===(null===(r=this.withModal.permit_row)||void 0===r?void 0:r.state),this.withModal.hide_permit_btn&&(this.canyuShow=!1),this.withModal.type)switch(this.withModal.type){case"edit":this.showBtn=!0,this.showSubmitBtn=!1,this.withModal.id?(this.disabled=!0,this.getDeatils(this.withModal.id)):this.Bool=!0;break;case"audit":this.showSubmitBtn=!1,this.disabled=!0,this.Bool=!0;break;case"create":this.Bool=!0;break;case"draft_edit":this.disabled=!1,this.showSubmitBtn=!1,this.getDraftDetail(this.withModal.id);break;default:break}}else this.state_name=this.$route.query.state_name,this.permit_type_name=this.$route.query.permit_type_name,this.istop="1"===this.$route.query.isTop,this.showIsTop="0"===this.$route.query.state,this.$route.query.canyuShow||void 0===this.$route.query.canyuShow||(this.canyuShow=this.$route.query.canyuShow),this.$route.query.qianshu&&(this.showSubmitBtn=!0,this.details=Object.assign({remarks:"",file:[],type:4,contract_party_a_company_id:"",contract_party_b_company_id:"",contract_name:"",contract_money:"",is_project:"",project_id:"",tariff:"",is_main:"",is_subcontract:"",contract_pid:"",subcontract_remarks:""},JSON.parse(this.$route.query.qianshu)),console.log("this.details",this.details)),this.$route.query.isEdit&&(this.showSubmitBtn=!0),this.$route.query.showBtn&&(this.showSubmitBtn=!1,this.showBtn=!0),this.$route.query.typeData?(this.showSubmitBtn=!1,this.disabled=!0,this.Bool=!0):this.$route.query.id?(this.disabled=!0,this.getDeatils(this.$route.query.id)):this.Bool=!0},methods:{toProjectDetail:function(){var t=this,e=t.permit_response.info;"未签约"===e.main_contract_id?Object(y["c"])(this,"NewProject",{data:JSON.stringify(e),type:"edit",isTop:e.istop}):Object(y["c"])(this,"projectDetail",{id:e.id,isTop:e.istop})},syncPermitResp:function(t){this.permit_response=t},handleTop:function(t){var e=this;return Object(o["a"])(Object(s["a"])().mark((function t(){var a;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(d["a"])({id:e.withModal?e.withModal.permit_id:e.$route.query.id});case 2:a=t.sent,200===a.code&&(e.$message.success(a.msg),e.istop=!e.istop);case 4:case"end":return t.stop()}}),t)})))()},handlePass:function(t){var e=this;return Object(o["a"])(Object(s["a"])().mark((function t(){var a;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(f["j"])({id:e.shenpi.id,type:"1"});case 2:a=t.sent,200===a.code&&(e.$message.success(a.msg),e.$router.push({name:"pendApprovalList"}));case 4:case"end":return t.stop()}}),t)})))()},handleReject:function(t){var e=this;return Object(o["a"])(Object(s["a"])().mark((function t(){var a;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(f["j"])({id:e.shenpi.id,type:"2"});case 2:a=t.sent,200===a.code&&(e.$message.success(a.msg),e.$router.push({name:"pendApprovalList"}));case 4:case"end":return t.stop()}}),t)})))()},callback:function(t){this.state=t.state,this.shenpi=t},getDeatils:function(t){var e=this;return Object(o["a"])(Object(s["a"])().mark((function a(){var r;return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(j["c"])({id:t});case 2:r=a.sent,e.details=r.data,e.Bool=!0;case 5:case"end":return a.stop()}}),a)})))()},getDraftDetail:function(){var t=this;return Object(o["a"])(Object(s["a"])().mark((function e(){var a;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.withModal.id){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,t.formLoading=!0,e.next=6,Object(j["g"])({id:t.withModal.id});case 6:a=e.sent,t.details=a.data,t.Bool=!0,e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](2),w["Message"].error(e.t0.msg);case 14:return e.prev=14,t.formLoading=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[2,11,14,17]])})))()},handleNext:function(){var t=this.$refs.contractInfo.getFormData();t&&(this.contractInfoData=t,this.active++)},handleCreate:function(){var t=arguments,e=this;return Object(o["a"])(Object(s["a"])().mark((function a(){var r,i,o,c;return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(r=t.length>0&&void 0!==t[0]&&t[0],i=e.$refs.contractInfo.getFormData(),i){a.next=4;break}return a.abrupt("return");case 4:if("0"!==e.$route.query.type&&"create"!==e.withModal.type){a.next=16;break}return i.is_main=0,i.project_id=0,i.type=0,i.contract_pid=0,i.subcontract_remarks=0,a.next=12,Object(j["a"])(Object(n["a"])({},i));case 12:o=a.sent,200===o.code&&(e.active=2,e.$emit("refreshList"),e.$store.dispatch("company/updateAll","contract")),a.next=21;break;case 16:return console.log("contractInfoData",i),a.next=19,Object(j["a"])(Object(n["a"])({},i));case 19:c=a.sent,200===c.code&&(e.active=2,e.$emit("refreshList"),r?e.$emit("draftToCreate",e.withModal.id):e.$emit("refreshList"),e.$store.dispatch("company/updateAll","contract"));case 21:console.log("创建");case 22:case"end":return a.stop()}}),a)})))()},createContractDraft:function(){var t=this;return Object(o["a"])(Object(s["a"])().mark((function e(){var a,r;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=t.$refs.contractInfo.getFormData(),a){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,t.submitLoading=!0,e.next=7,Object(j["b"])(a);case 7:r=e.sent,200===r.code&&t.$message({type:"success",message:r.msg||"已保存为草稿"}),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](3),w["Message"].error(e.t0.msg||"保存出错");case 14:return e.prev=14,t.submitLoading=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[3,11,14,17]])})))()},editContractDraft:function(){var t=this;return Object(o["a"])(Object(s["a"])().mark((function e(){var a,r;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.withModal.data){e.next=2;break}return e.abrupt("return");case 2:if(a=t.$refs.contractInfo.getFormData(),a){e.next=5;break}return e.abrupt("return");case 5:return e.prev=5,t.submitLoading=!0,e.next=9,Object(j["b"])(Object(n["a"])(Object(n["a"])({},a),{},{id:t.withModal.data.id}));case 9:r=e.sent,200===r.code&&(t.$message({type:"success",message:r.msg||"修改成功"}),t.$emit("refreshList"),t.$emit("close")),e.next=16;break;case 13:e.prev=13,e.t0=e["catch"](5),w["Message"].error(e.t0.msg||"保存出错");case 16:return e.prev=16,t.submitLoading=!1,e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[5,13,16,19]])})))()},Recreate:function(){this.$refs.contractInfo.resetForm(),this.active=0},handleBack:function(){}}},O=k,x=(a("b29e"),Object(b["a"])(O,r,i,!1,null,"6923768c",null));e["default"]=x.exports},"8f1a":function(t,e,a){"use strict";a("68fc")},9437:function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));var r=a("b775");function i(t){return Object(r["a"])({url:"Publics/upload",method:"post",data:t,headers:{"content-type":"multipart/form-data"}})}},"9a04":function(t,e,a){t.exports=a.p+"static/img/checking.73c367ae.png"},ac6f:function(t,e,a){t.exports=a.p+"static/img/refuted.d21e0353.png"},b29e:function(t,e,a){"use strict";a("bc75")},b65c:function(t,e,a){"use strict";a("227c")},b98c:function(t,e,a){"use strict";a("cbb6")},bc75:function(t,e,a){},cbb6:function(t,e,a){},ed08:function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"a",(function(){return s})),a.d(e,"c",(function(){return o}));a("53ca"),a("d81d"),a("a434"),a("d3b7"),a("4d63"),a("ac1f"),a("2c3e"),a("00b4"),a("25f0"),a("4d90"),a("5319"),a("0643"),a("4e3e"),a("a573"),a("159b");var r=a("21a6"),i=a("25ca");a("bc3a"),a("aeb1");function n(t,e,a,n){var s=[],o=[],c=function(t){var e=0;for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&e++;return e};for(var l in t)if(console.log("------------------------"),Object.prototype.hasOwnProperty.call(t,l)){var d=t[l],u=[];for(var m in d)if(Object.prototype.hasOwnProperty.call(d,m)){var f=d[m];u.push(f),o.length<c(d)&&o.push(m)}s.push(u)}var p=[];a.map((function(t,e){"快速操作"!=t&&"详情"!=t&&p.push(t)})),s.splice(0,0,o,p),console.log("excel_data",i);var h=i["utils"].aoa_to_sheet(s),b=i["utils"].book_new(),_=[{hidden:!0}];h["!rows"]=_,i["utils"].book_append_sheet(b,h,n);var v=i["write"](b,{bookType:"xlsx",type:"array"}),g=new Blob([v],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});Object(r["saveAs"])(g,e+".xlsx")}function s(t){var e=-1!==t.lastIndexOf("?")?decodeURIComponent(t.substring(t.lastIndexOf("/")+1,t.lastIndexOf("?"))):decodeURIComponent(t.substring(t.lastIndexOf("/")+1)),a=e.substring(e.lastIndexOf(".")+1);if("png"==a||"jpg"==a||"pdf"==a){var i=document.createElement("a");i.href=t,i.download=e,i.target="_blank",i.click()}else fetch(t,{mode:"no-cors"}).then((function(t){return t.blob()})).then((function(t){console.log("blob",t),Object(r["saveAs"])(t,e)}))}function o(t,e,a){console.log("self",t);var r=t.$router.resolve({name:e,query:a}),i=window.open(r.href,e);i&&i.location.reload()}}}]);