(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8db4c1f8","chunk-5d235037"],{"0993":function(e,t,a){e.exports=a.p+"static/img/checked.f8521b5f.png"},1423:function(e,t,a){},1825:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"newApproval"},[e._e(),a("div",{staticStyle:{width:"650px",margin:"0 auto"}},[0==e.active?a("el-form",{ref:"ruleForm",staticClass:"newApprovalForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"150px",size:"medium"}},[e.step?e._e():a("el-form-item",{attrs:{label:"项目名称",prop:"project_id"}},[a("el-select",{attrs:{disabled:e.disableFlag,placeholder:"请选择",filterable:"",clearable:""},on:{change:e.handleProjectChange},model:{value:e.ruleForm.project_id,callback:function(t){e.$set(e.ruleForm,"project_id",t)},expression:"ruleForm.project_id"}},e._l(e.projectList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.project_name,value:e.id}})})),1)],1),e.step?e._e():a("el-form-item",{attrs:{label:"项目负责人",prop:"contacts_name"}},[a("el-select",{attrs:{disabled:!0,placeholder:"请选择",filterable:"",clearable:""},model:{value:e.ruleForm.contacts_name,callback:function(t){e.$set(e.ruleForm,"contacts_name",t)},expression:"ruleForm.contacts_name"}},e._l(e.projectList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.contacts_name,value:e.id}})})),1)],1),e.step?e._e():a("el-form-item",{attrs:{label:"招标公司",prop:"company_id"}},[a("el-select",{attrs:{disabled:!0,placeholder:"请选择",filterable:"",clearable:""},model:{value:e.ruleForm.company_id,callback:function(t){e.$set(e.ruleForm,"company_id",t)},expression:"ruleForm.company_id"}},e._l(e.companyList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),e.step?e._e():a("el-form-item",{attrs:{label:"投标公司",prop:"bid_company_id"}},[a("el-select",{attrs:{disabled:!0,placeholder:"请选择",filterable:"",clearable:""},model:{value:e.ruleForm.bid_company_id,callback:function(t){e.$set(e.ruleForm,"bid_company_id",t)},expression:"ruleForm.bid_company_id"}},e._l(e.companyList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"付款方式",prop:"pay_type"}},[a("el-select",{attrs:{disabled:e.disableFlag,placeholder:"请选择",filterable:"",clearable:""},model:{value:e.ruleForm.pay_type,callback:function(t){e.$set(e.ruleForm,"pay_type",t)},expression:"ruleForm.pay_type"}},e._l(e.payTypeList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"付款账户类型",prop:"payment_type"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择付款账户类型",disabled:e.detailToCreate},model:{value:e.ruleForm.payment_type,callback:function(t){e.$set(e.ruleForm,"payment_type",t)},expression:"ruleForm.payment_type"}},[a("el-option",{attrs:{label:"公司",value:1}}),a("el-option",{attrs:{label:"个人",value:2}})],1)],1),1==e.ruleForm.payment_type?[a("el-form-item",{attrs:{label:"付款方",prop:"payment_company_id"}},[a("el-select",{attrs:{disabled:e.disableFlag,placeholder:"请选择",filterable:"",clearable:""},model:{value:e.ruleForm.payment_company_id,callback:function(t){e.$set(e.ruleForm,"payment_company_id",t)},expression:"ruleForm.payment_company_id"}},e._l(e.companyList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),1==e.ruleForm.pay_type||4==e.ruleForm.pay_type?a("el-form-item",{attrs:{label:"付款账号",prop:"payment_company_bank_id"}},[a("el-select",{attrs:{disabled:!e.ruleForm.payment_company_id||e.disableFlag,placeholder:"请选择",filterable:"",clearable:""},model:{value:e.ruleForm.payment_company_bank_id,callback:function(t){e.$set(e.ruleForm,"payment_company_bank_id",t)},expression:"ruleForm.payment_company_bank_id"}},e._l(e.companyListAccount,(function(e){return a("el-option",{key:e.id,attrs:{label:e.open_bank+":"+e.bank_number,value:e.id}})})),1)],1):e._e()]:e._e(),2==e.ruleForm.payment_type?[a("el-form-item",{attrs:{label:"个人付款id",prop:"payment_staff_id"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",clearable:"",filterable:""},model:{value:e.ruleForm.payment_staff_id,callback:function(t){e.$set(e.ruleForm,"payment_staff_id",t)},expression:"ruleForm.payment_staff_id"}},e._l(e.staffList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),1==e.ruleForm.pay_type||4==e.ruleForm.pay_type?a("el-form-item",{attrs:{label:"个人付款账户",prop:"payment_staff_bank_id"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",clearable:"",filterable:""},model:{value:e.ruleForm.payment_staff_bank_id,callback:function(t){e.$set(e.ruleForm,"payment_staff_bank_id",t)},expression:"ruleForm.payment_staff_bank_id"}},e._l(e.payment_staff_bank_idArr,(function(e){return a("el-option",{key:e.id,attrs:{label:e.open_bank+":"+e.bank_number,value:e.id}})})),1)],1):e._e()]:e._e(),a("el-form-item",{attrs:{label:"收款账户类型",prop:"revenue_type"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择收款账户类型",disabled:e.detailToCreate},model:{value:e.ruleForm.revenue_type,callback:function(t){e.$set(e.ruleForm,"revenue_type",t)},expression:"ruleForm.revenue_type"}},[a("el-option",{attrs:{label:"公司",value:1}}),a("el-option",{attrs:{label:"个人",value:2}})],1)],1),1==e.ruleForm.revenue_type?[a("el-form-item",{attrs:{label:"收款方",prop:"revenue_company_id"}},[a("el-select",{attrs:{disabled:e.disableFlag,placeholder:"请选择",filterable:"",clearable:""},model:{value:e.ruleForm.revenue_company_id,callback:function(t){e.$set(e.ruleForm,"revenue_company_id",t)},expression:"ruleForm.revenue_company_id"}},e._l(e.companyList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),1==e.ruleForm.pay_type||4==e.ruleForm.pay_type?a("el-form-item",{attrs:{label:"收款账户",prop:"revenue_company_bank_id"}},[a("el-select",{attrs:{disabled:!e.ruleForm.revenue_company_id||e.disableFlag,placeholder:"请选择",filterable:"",clearable:""},model:{value:e.ruleForm.revenue_company_bank_id,callback:function(t){e.$set(e.ruleForm,"revenue_company_bank_id",t)},expression:"ruleForm.revenue_company_bank_id"}},e._l(e.companyListAccountRevenue,(function(e){return a("el-option",{key:e.id,attrs:{label:e.open_bank+":"+e.bank_number,value:e.id}})})),1)],1):e._e()]:e._e(),2==e.ruleForm.revenue_type?[a("el-form-item",{attrs:{label:"个人收款id",prop:"revenue_staff_id"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",clearable:"",filterable:""},model:{value:e.ruleForm.revenue_staff_id,callback:function(t){e.$set(e.ruleForm,"revenue_staff_id",t)},expression:"ruleForm.revenue_staff_id"}},e._l(e.staffList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),1==e.ruleForm.pay_type||4==e.ruleForm.pay_type?a("el-form-item",{attrs:{label:"个人收款账户",prop:"revenue_staff_bank_id"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",filterable:"",clearable:""},model:{value:e.ruleForm.revenue_staff_bank_id,callback:function(t){e.$set(e.ruleForm,"revenue_staff_bank_id",t)},expression:"ruleForm.revenue_staff_bank_id"}},e._l(e.revenue_staff_idArr,(function(e){return a("el-option",{key:e.id,attrs:{label:e.open_bank+":"+e.bank_number,value:e.id}})})),1)],1):e._e()]:e._e(),a("el-form-item",{attrs:{label:"付款金额",prop:"payment_money"}},[a("el-input",{staticClass:"moneyStyle",attrs:{title:e.ruleForm.payment_money,disabled:e.disableFlag,placeholder:"请输入"},model:{value:e.ruleForm.payment_money,callback:function(t){e.$set(e.ruleForm,"payment_money",t)},expression:"ruleForm.payment_money"}})],1),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{title:e.ruleForm.remarks,placeholder:"请输入",disabled:e.disableFlag},model:{value:e.ruleForm.remarks,callback:function(t){e.$set(e.ruleForm,"remarks",t)},expression:"ruleForm.remarks"}})],1),2==e.active?a("el-form-item",{attrs:{label:"备注信息",prop:"remarks"}},[a("el-input",{attrs:{title:e.ruleForm.remarks,disabled:e.disableFlag,type:"textarea"},model:{value:e.ruleForm.remarks,callback:function(t){e.$set(e.ruleForm,"remarks",t)},expression:"ruleForm.remarks"}})],1):e._e(),a("el-form-item",{attrs:{label:"相关附件",prop:"receipt"}},[a("el-upload",{staticClass:"upload-demo",attrs:{action:"##","file-list":e.fileList,"before-upload":e.beforUpload,"on-remove":e.handleRemove,"before-remove":e.beforeRemove,"on-preview":e.handleDown}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1)],1),a("el-form-item",[a("el-button",{staticStyle:{"margin-top":"12px"},attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("提交")])],1)],2):e._e()],1)])},n=[],s=a("c7eb"),r=a("1da1"),l=a("5530"),o=a("ade3"),p=(a("7db0"),a("caad"),a("d81d"),a("b0c0"),a("e9c4"),a("a9e3"),a("b64b"),a("d3b7"),a("0643"),a("fffc"),a("4e3e"),a("a573"),a("159b"),a("fef7")),d=a("277f"),c=a("9437"),_=a("2f62"),m={components:{ProgressBar:p["a"]},props:{withModal:{type:Object,default:void 0}},data:function(){var e=this;return{detailToCreate:!1,disableFlag:!1,step:!1,loding:!1,id:"",fileList:[],barWidth:"",active:0,payTypeList:[{label:"网银转账",value:1},{label:"现钞",value:2},{label:"担保手续",value:3},{label:"网银转账+担保手续",value:4},{label:"现钞+借据",value:5},{label:"投标保证金保函/保险",value:6}],arr:[{stepTitle:"客户垫付",stepDesc:""},{stepTitle:"支付投标人",stepDesc:""},{stepTitle:"支付招标方",stepDesc:""},{stepTitle:"退还投标人",stepDesc:""},{stepTitle:"退还集团",stepDesc:""},{stepTitle:"退还客户",stepDesc:"必须退回客户原账户"}],ruleForm:{project_id:"",payment_company_id:"",payment_company_bank_id:"",revenue_company_id:"",revenue_company_bank_id:"",payment_money:"",pay_type:"",remarks:"",payment_type:1,payment_staff_id:"",payment_staff_bank_id:"",revenue_type:1,revenue_staff_id:"",revenue_staff_bank_id:"",client_company_id:"",bid_company_id:"",contacts_name:"",company_id:""},rules:Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])({project_id:[{required:!0,message:"请选择项目名称",trigger:"change"}],payment_company_id:[{required:!0,message:"请选择付款方",trigger:"change"}],payment_company_bank_id:[{required:!0,message:"请选择付款账号",trigger:"change"}],payment_staff_id:[{required:!0,message:"请选择个人付款id",trigger:"change"}],payment_staff_bank_id:[{required:!0,message:"请选择个人付款账户",trigger:"change"}],revenue_company_id:[{required:!0,message:"请选择收款方",trigger:"change"}],revenue_company_bank_id:[{required:!0,message:"请选择收款账户",trigger:"change"}],revenue_staff_id:[{required:!0,message:"请选择个人收款id",trigger:"change"}],revenue_staff_bank_id:[{required:!0,message:"请选择个人收款账户",trigger:"change"}],payment_money:[{required:!0,message:"请输入金额",trigger:"blur"}],pay_type:[{required:!0,message:"请选择付款方式",trigger:"change"}],remarks:[{required:!0,message:"请输入备注信息",trigger:"blur"}],receipt:[{required:!0,validator:function(t,a,i){0==e.fileList.length?i(new Error("请上传银行回执/借据")):i()}}],client_company_id:[{required:!0,message:"请选择客户公司",trigger:"blur"}]},"payment_staff_id",[{required:!0,message:"请选择付款方",trigger:"blur"}]),"payment_staff_bank_id",[{required:!0,message:"请选择付款方账号",trigger:"blur"}]),"revenue_staff_id",[{required:!0,message:"请选择收款方",trigger:"blur"}]),"revenue_staff_bank_id",[{required:!0,message:"请选择收款账号",trigger:"blur"}]),companyList:[],projectList:[],companyListAccount:[],companyListAccountRevenue:[],payment_staff_bank_idArr:[],revenue_staff_idArr:[]}},computed:{staffList:function(){return this.$store.state.company.staffList}},watch:{"ruleForm.payment_company_id":{handler:function(e,t){var a=this;e!=t&&t&&(this.ruleForm.payment_company_bank_id=""),e?this.$store.state.company.companyList.forEach((function(t){t.id==e&&(a.companyListAccount=t.companyBankList)})):(this.ruleForm.payment_company_bank_id="",this.companyListAccount=[])},deep:!0},"ruleForm.revenue_company_id":{handler:function(e,t){var a=this;e!=t&&t&&(this.ruleForm.revenue_company_bank_id=""),e?this.$store.state.company.companyList.forEach((function(t){t.id==e&&(a.companyListAccountRevenue=t.companyBankList)})):(this.ruleForm.revenue_company_bank_id="",this.companyListAccountRevenue=[])},deep:!0},"ruleForm.payment_staff_id":{handler:function(e,t){var a=this;e!=t&&t&&(this.ruleForm.payment_staff_bank_id=""),e&&this.$store.state.company.staffList.map((function(t){t.id==e&&(a.payment_staff_bank_idArr=t.staffBankList)}))},deep:!0},"ruleForm.revenue_staff_id":{handler:function(e,t){var a=this;e!=t&&t&&(this.ruleForm.revenue_staff_bank_id=""),e&&this.$store.state.company.staffList.map((function(t){t.id==e&&(a.revenue_staff_idArr=t.staffBankList)}))},deep:!0},fileList:{handler:function(e,t){e.length>0&&this.$refs.ruleForm.validateField("receipt")},deep:!0}},mounted:function(){var e,t,a,i=this;if(this.companyList=this.$store.state.company.companyList,this.projectList=this.$store.state.company.projectList,this.withModal){if(this.withModal.type){var n=this.withModal.type;switch(n){case"create":break;case"edit":if(this.id=this.withModal.id,this.step=this.withModal.step,this.withModal.data){var s,r=this.withModal.data;this.fileList=r.file?JSON.parse(r.file).map((function(e){return{url:e,name:i.getFileName(e)}})):[],this.$store.state.company.companyList.map((function(e){e.id===r.payment_company_id&&(i.companyListAccount=e.companyBankList),e.id===r.revenue_company_id&&(i.companyListAccountRevenue=e.companyBankList)})),this.ruleForm={bid_company_id:r.client_company_id,payment_type:r.payment_type,revenue_type:r.revenue_type,project_id:this.$route.params.id||(null===(s=this.withModal)||void 0===s?void 0:s.id),payment_company_id:r.payment_company_id,payment_company_bank_id:r.payment_company_bank_id?Number(r.payment_company_bank_id):"",revenue_company_id:r.payment_company_bank_id?Number(r.revenue_company_id):"",revenue_company_bank_id:r.revenue_company_bank_id?Number(r.revenue_company_bank_id):"",payment_money:r.payment_money,pay_type:r.pay_type?Number(r.pay_type):"",remarks:r.remarks,file:r.file,payment_staff_id:r.payment_staff_id,payment_staff_bank_id:r.payment_staff_bank_id,revenue_staff_id:r.revenue_staff_id,revenue_staff_bank_id:r.revenue_staff_bank_id},this.$forceUpdate()}break;default:break}}}else{var l,o;if(this.$route.params.id||null!==(e=this.withModal)&&void 0!==e&&e.id)this.id=this.$route.params.id||(null===(l=this.withModal)||void 0===l?void 0:l.id);if(this.$route.params.step||null!==(t=this.withModal)&&void 0!==t&&t.step)this.step=this.$route.params.step||(null===(o=this.withModal)||void 0===o?void 0:o.step),console.log(" this.step",this.step);if(console.log("this.$route.params.data",this.$route.params.data),this.$route.params.data||null!==(a=this.withModal)&&void 0!==a&&a.data){var p,d,c=this.$route.params.data||(null===(p=this.withModal)||void 0===p?void 0:p.data);this.fileList=c.file?JSON.parse(c.file).map((function(e){return{url:e,name:i.getFileName(e)}})):[],this.$store.state.company.companyList.map((function(e){e.id==c.payment_company_id&&(i.companyListAccount=e.companyBankList),e.id==c.revenue_company_id&&(i.companyListAccountRevenue=e.companyBankList)})),this.ruleForm={bid_company_id:c.client_company_id,payment_type:c.payment_type,revenue_type:c.revenue_type,project_id:this.$route.params.id||(null===(d=this.withModal)||void 0===d?void 0:d.id),payment_company_id:c.payment_company_id,payment_company_bank_id:c.payment_company_bank_id?Number(c.payment_company_bank_id):"",revenue_company_id:c.payment_company_bank_id?Number(c.revenue_company_id):"",revenue_company_bank_id:c.revenue_company_bank_id?Number(c.revenue_company_bank_id):"",payment_money:c.payment_money,pay_type:c.pay_type?Number(c.pay_type):"",remarks:c.remarks,file:c.file,payment_staff_id:c.payment_staff_id,payment_staff_bank_id:c.payment_staff_bank_id,revenue_staff_id:c.revenue_staff_id,revenue_staff_bank_id:c.revenue_staff_bank_id},this.$forceUpdate(),console.log("this.ruleFormthis.ruleFormthis.ruleFormthis.ruleForm",this.ruleForm)}}},methods:Object(l["a"])(Object(l["a"])({},Object(_["c"])("app",["OPEN_PREVIEW"])),{},{handleDown:function(e){var t,a=e.name.split(".").pop();["pdf"].includes(a)&&(t="pdf"),["doc","docx"].includes(a)&&(t="doc"),["png","jpg","jpeg","gif","bmp"].includes(a)&&(t="pic"),this.OPEN_PREVIEW({url:e.url,type:t})},beforUpload:function(e){var t=this,a=new FormData;return a.append("files",e),Object(c["a"])(a).then((function(a){200==a.code&&(e.url=a.data.file,t.fileList.push(e))})),!1},handleRemove:function(e,t){this.fileList=t},beforeRemove:function(){},getFileName:function(e){return-1!==e.lastIndexOf("?")?decodeURIComponent(e.substring(e.lastIndexOf("/")+1,e.lastIndexOf("?"))):decodeURIComponent(e.substring(e.lastIndexOf("/")+1))},submitForm:function(e){var t=this,a=this;this.$refs[e].validate(function(){var e=Object(r["a"])(Object(s["a"])().mark((function e(i){var n,r,l,o,p;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!i){e.next=18;break}if(t.ruleForm.file=JSON.stringify(t.fileList.map((function(e){return e.url}))),console.log("step,data",a.$route.params.step,a.$route.params.data),!(a.$route.params.step||null!==(n=a.withModal)&&void 0!==n&&n.step||a.$route.params.data||null!==(r=a.withModal)&&void 0!==r&&r.data)){e.next=11;break}return l=Object.assign(t.ruleForm,{phase:t.step,id:t.id}),e.next=7,Object(d["e"])(l);case 7:o=e.sent,200==o.code&&(t.$emit("refreshList"),t.$emit("close")),e.next=15;break;case 11:return e.next=13,Object(d["c"])(t.ruleForm);case 13:p=e.sent,200==p.code&&(t.$emit("refreshList"),t.$emit("close"));case 15:t.next(),e.next=20;break;case 18:return console.log("error submit!!"),e.abrupt("return",!1);case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},next:function(){this.active++>1&&(this.active=0),this.active++>1&&(this.active=0)},handleProjectChange:function(e){this.ruleForm.contacts_name=e;var t=this.projectList.find((function(t){return t.id==e}));this.ruleForm.company_id=t.company_id,this.ruleForm.bid_company_id=t.bid_company_id}})},u=m,y=(a("7cce"),a("2877")),f=Object(y["a"])(u,i,n,!1,null,"11bbc06d",null);t["default"]=f.exports},"77b4":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e.showSubmitBtn?e._e():i("div",{staticStyle:{position:"absolute",top:"50px",right:"300px","z-index":"10"}},["已审批"==e.state_name?i("img",{staticStyle:{display:"block",width:"150px"},attrs:{src:a("0993"),alt:""}}):e._e(),"审批中"==e.state_name?i("img",{staticStyle:{display:"block",width:"150px"},attrs:{src:a("9a04"),alt:""}}):e._e(),"已驳回"==e.state_name?i("img",{staticStyle:{display:"block",width:"150px"},attrs:{src:a("ac6f"),alt:""}}):e._e()]),e.permit_type_name?i("div",{staticStyle:{"margin-top":"50px"}},[i("span",{staticStyle:{"padding-left":"20px",color:"#666666","padding-top":"50px"}},[e._v("审批事项："+e._s(e.permit_type_name))]),e.showIsTop?i("el-button",{staticStyle:{"margin-left":"20px"},attrs:{size:"small",type:"primary"},on:{click:e.handleTop}},[e._v(e._s(e.istop?"取消置顶":"置顶主页"))]):e._e()],1):e._e(),i("div",{staticStyle:{display:"flex",width:"100%","justify-content":"center","margin-top":"150px"}},[i("el-steps",{staticStyle:{position:"relative"},attrs:{active:e.active,"finish-status":"success"}},[i("div",{staticStyle:{position:"absolute",top:"-80px",left:"0"}},[i("div",{staticStyle:{"margin-bottom":"10px"}},[e._v("项目名称："),i("span",{staticStyle:{color:"#666666"}},[e._v(e._s(e.details.project_name))])]),i("div",[e._v("保证金金额："),i("span",{staticStyle:{color:"#666666"}},[e._v(e._s(e.details.earnest_money))])])]),e._l(e.details.permit_process,(function(t,a){return i("el-step",{key:a,class:"已驳回"==t.name?"redColor":"",staticStyle:{width:"200px"},attrs:{title:t.name}},[i("template",{slot:"description"},[a==e.active&&1==e.details.permitting_state?i("div",[i("div",{staticStyle:{"margin-left":"-60px",width:"200px"}},[i("div",{staticStyle:{width:"180px",margin:"0 auto"}},[i("div",{staticStyle:{height:"100px",width:"1px","border-left":"1px solid #eee",margin:"0 auto"}}),i("div",{staticStyle:{width:"180px",border:"1px solid #eee",margin:"0 auto",color:"black",padding:"20px"}},[i("p",[i("el-button",{attrs:{disabled:e.typeStatus,size:"mini",type:"primary"},on:{click:function(t){e.handleDetails(e.active+1,e.details.id,e.active+1<e.details.permit_process.length?null:e.details["step_1"])}}},[e._v("创建")])],1)])])])]):e._e(),0==a&&e.details.step_1?i("div",{staticStyle:{"margin-left":"-60px",width:"200px"}},[i("div",{staticStyle:{width:"180px",margin:"0 auto"}},[i("div",{staticStyle:{height:"100px",width:"1px","border-left":"1px solid #eee",margin:"0 auto"}}),i("div",{staticStyle:{width:"180px",border:"1px solid #eee",margin:"0 auto",color:"black",padding:"20px"}},[i("p",[e._v("付款方式："),i("span",[e._v(e._s(e.details.step_1.pay_type_name))])]),i("p",[e._v("付款方："),i("span",[e._v(e._s(e.details.step_1.payment_company_name))])]),i("p",[e._v("付款账号："),i("span",[e._v(e._s(e.details.step_1.payment_company_bank_number))])]),i("p",[e._v("收款方："),i("span",[e._v(e._s(e.details.step_1.revenue_company_name))])]),i("p",[e._v("收款账号："),i("span",[e._v(e._s(e.details.step_1.revenue_company_bank_number))])]),i("p",[e._v("金额："),i("span",[e._v(e._s(e.details.step_1.payment_money))])]),i("p",[e._v("备注："),i("span",[e._v(e._s(e.details.step_1.remarks))])]),i("p",[e._v("创建时间："),i("span",[e._v(e._s(e.details.step_1.create_time))])]),i("p",{staticStyle:{display:"flex"}},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.handlePreView("1")}}},[e._v("查看回执")]),i("el-button",{attrs:{disabled:e.typeStatus||3!==e.details.permitting_state,size:"mini",type:"primary"},on:{click:function(t){return e.handleDetails(1,e.details.id,e.details.step_1)}}},[e._v("编辑")])],1)])])]):e._e(),1==a&&e.details.step_2?i("div",{staticStyle:{"margin-left":"-60px",width:"200px"}},[i("div",{staticStyle:{width:"180px",margin:"0 auto"}},[i("div",{staticStyle:{height:"100px",width:"1px","border-left":"1px solid #eee",margin:"0 auto"}}),i("div",{staticStyle:{width:"180px",border:"1px solid #eee",margin:"0 auto",color:"black",padding:"20px"}},[i("p",[e._v("付款方式："),i("span",[e._v(e._s(e.details.step_2.pay_type_name))])]),i("p",[e._v("付款方："),i("span",[e._v(e._s(e.details.step_2.payment_company_name))])]),i("p",[e._v("付款账号："),i("span",[e._v(e._s(e.details.step_2.payment_company_bank_number))])]),i("p",[e._v("收款方："),i("span",[e._v(e._s(e.details.step_2.revenue_company_name))])]),i("p",[e._v("收款账号："),i("span",[e._v(e._s(e.details.step_2.revenue_company_bank_number))])]),i("p",[e._v("金额："),i("span",[e._v(e._s(e.details.step_2.payment_money))])]),i("p",[e._v("备注："),i("span",[e._v(e._s(e.details.step_2.remarks))])]),i("p",[e._v("创建时间："),i("span",[e._v(e._s(e.details.step_2.create_time))])]),i("p",{staticStyle:{display:"flex"}},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.handlePreView("2")}}},[e._v("查看回执")]),i("el-button",{attrs:{disabled:e.typeStatus||3!==e.details.permitting_state,size:"mini",type:"primary"},on:{click:function(t){return e.handleDetails(2,e.details.id,e.details.step_2)}}},[e._v("编辑")])],1)])])]):e._e(),2==a&&e.details.step_3?i("div",{staticStyle:{"margin-left":"-60px",width:"200px"}},[i("div",{staticStyle:{width:"180px",margin:"0 auto"}},[i("div",{staticStyle:{height:"100px",width:"1px","border-left":"1px solid #eee",margin:"0 auto"}}),i("div",{staticStyle:{width:"180px",border:"1px solid #eee",margin:"0 auto",color:"black",padding:"20px"}},[i("p",[e._v("付款方式："),i("span",[e._v(e._s(e.details.step_3.pay_type_name))])]),i("p",[e._v("付款方："),i("span",[e._v(e._s(e.details.step_3.payment_company_name))])]),i("p",[e._v("付款账号："),i("span",[e._v(e._s(e.details.step_3.payment_company_bank_number))])]),i("p",[e._v("收款方："),i("span",[e._v(e._s(e.details.step_3.revenue_company_name))])]),i("p",[e._v("收款账号："),i("span",[e._v(e._s(e.details.step_3.revenue_company_bank_number))])]),i("p",[e._v("金额："),i("span",[e._v(e._s(e.details.step_3.payment_money))])]),i("p",[e._v("备注："),i("span",[e._v(e._s(e.details.step_3.remarks))])]),i("p",[e._v("创建时间："),i("span",[e._v(e._s(e.details.step_3.create_time))])]),i("p",{staticStyle:{display:"flex"}},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.handlePreView("3")}}},[e._v("查看回执")]),i("el-button",{attrs:{disabled:e.typeStatus||3!==e.details.permitting_state,size:"mini",type:"primary"},on:{click:function(t){return e.handleDetails(3,e.details.id,e.details.step_3)}}},[e._v("编辑")])],1)])])]):e._e(),3==a&&e.details.step_4?i("div",{staticStyle:{"margin-left":"-60px",width:"200px"}},[i("div",{staticStyle:{width:"180px",margin:"0 auto"}},[i("div",{staticStyle:{height:"100px",width:"1px","border-left":"1px solid #eee",margin:"0 auto"}}),i("div",{staticStyle:{width:"180px",border:"1px solid #eee",margin:"0 auto",color:"black",padding:"20px"}},[i("p",[e._v("付款方式："),i("span",[e._v(e._s(e.details.step_4.pay_type_name))])]),i("p",[e._v("付款方："),i("span",[e._v(e._s(e.details.step_4.payment_company_name))])]),i("p",[e._v("付款账号："),i("span",[e._v(e._s(e.details.step_4.payment_company_bank_number))])]),i("p",[e._v("收款方："),i("span",[e._v(e._s(e.details.step_4.revenue_company_name))])]),i("p",[e._v("收款账号："),i("span",[e._v(e._s(e.details.step_4.revenue_company_bank_number))])]),i("p",[e._v("金额："),i("span",[e._v(e._s(e.details.step_4.payment_money))])]),i("p",[e._v("备注："),i("span",[e._v(e._s(e.details.step_4.remarks))])]),i("p",[e._v("创建时间："),i("span",[e._v(e._s(e.details.step_4.create_time))])]),i("p",{staticStyle:{display:"flex"}},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.handlePreView("4")}}},[e._v("查看回执")]),i("el-button",{attrs:{disabled:e.typeStatus||3!==e.details.permitting_state,size:"mini",type:"primary"},on:{click:function(t){return e.handleDetails(4,e.details.id,e.details.step_4)}}},[e._v("编辑")])],1)])])]):e._e(),4==a&&e.details.step_5?i("div",{staticStyle:{"margin-left":"-60px",width:"200px"}},[i("div",{staticStyle:{width:"180px",margin:"0 auto"}},[i("div",{staticStyle:{height:"100px",width:"1px","border-left":"1px solid #eee",margin:"0 auto"}}),i("div",{staticStyle:{width:"180px",border:"1px solid #eee",margin:"0 auto",color:"black",padding:"20px"}},[i("p",[e._v("付款方式："),i("span",[e._v(e._s(e.details.step_5.pay_type_name))])]),i("p",[e._v("付款方："),i("span",[e._v(e._s(e.details.step_5.payment_company_name))])]),i("p",[e._v("付款账号："),i("span",[e._v(e._s(e.details.step_5.payment_company_bank_number))])]),i("p",[e._v("收款方："),i("span",[e._v(e._s(e.details.step_5.revenue_company_name))])]),i("p",[e._v("收款账号："),i("span",[e._v(e._s(e.details.step_5.revenue_company_bank_number))])]),i("p",[e._v("金额："),i("span",[e._v(e._s(e.details.step_5.payment_money))])]),i("p",[e._v("备注："),i("span",[e._v(e._s(e.details.step_5.remarks))])]),i("p",[e._v("创建时间："),i("span",[e._v(e._s(e.details.step_5.create_time))])]),i("p",{staticStyle:{display:"flex"}},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.handlePreView("5")}}},[e._v("查看回执")]),i("el-button",{attrs:{disabled:e.typeStatus||3!==e.details.permitting_state,size:"mini",type:"primary"},on:{click:function(t){return e.handleDetails(5,e.details.id,e.details.step_5)}}},[e._v("编辑")])],1)])])]):e._e(),5==a&&e.details.step_6?i("div",{staticStyle:{"margin-left":"-60px",width:"200px"}},[i("div",{staticStyle:{width:"180px",margin:"0 auto"}},[i("div",{staticStyle:{height:"100px",width:"1px","border-left":"1px solid #eee",margin:"0 auto"}}),i("div",{staticStyle:{width:"180px",border:"1px solid #eee",margin:"0 auto",color:"black",padding:"20px"}},[i("p",[e._v("付款方式："),i("span",[e._v(e._s(e.details.step_6.pay_type_name))])]),i("p",[e._v("付款方："),i("span",[e._v(e._s(e.details.step_6.payment_company_name))])]),i("p",[e._v("付款账号："),i("span",[e._v(e._s(e.details.step_6.payment_company_bank_number))])]),i("p",[e._v("收款方："),i("span",[e._v(e._s(e.details.step_6.revenue_company_name))])]),i("p",[e._v("收款账号："),i("span",[e._v(e._s(e.details.step_6.revenue_company_bank_number))])]),i("p",[e._v("金额："),i("span",[e._v(e._s(e.details.step_6.payment_money))])]),i("p",[e._v("备注："),i("span",[e._v(e._s(e.details.step_6.remarks))])]),i("p",[e._v("创建时间："),i("span",[e._v(e._s(e.details.step_6.create_time))])]),i("p",{staticStyle:{display:"flex"}},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.handlePreView("6")}}},[e._v("查看回执")]),i("el-button",{attrs:{disabled:e.typeStatus||3!==e.details.permitting_state,size:"mini",type:"primary"},on:{click:function(t){return e.handleDetails(6,e.details.id,e.details.step_6)}}},[e._v("编辑")])],1)])])]):e._e()])],2)}))],2)],1),e.canyuShow?i("div",[e.showSubmitBtn||0!=e.state?e._e():i("div",{staticClass:"action",staticStyle:{"text-align":"center","margin-top":"20px","margin-bottom":"200px"}},[i("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.handlePass(e.state)}}},[e._v("通过")]),i("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(t){return e.handleReject(e.state)}}},[e._v("驳回")]),e.permit_response&&void 0!==e.permit_response.project_id?i("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.toProjectDetail}},[e._v("Go项目脑图审批")]):e._e()],1)]):e._e(),i("el-dialog",{attrs:{title:"回执单查看",visible:e.preViewImg,"append-to-body":!0},on:{"update:visible":function(t){e.preViewImg=t}}},[0==e.fileUrl.length?i("div",[e._v("无回执")]):e._e(),e.fileUrl.length?i("div",e._l(e.fileUrl,(function(t,a){return i("div",{key:a,staticClass:"receipt_item"},[i("div",[e._v(e._s(t))]),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){return e.handleReceipt(t)}}},[e._v("查看")])],1)})),0):e._e()]),i("el-dialog",{attrs:{width:"70vw",visible:e.showDetailModal,"destroy-on-close":!0,"append-to-body":!0},on:{"update:visible":function(t){e.showDetailModal=t},close:e.modalClose}},[e.showDetailModal?i("detail-modal",{attrs:{height:"70vh"}},[e.modalFreshControl?i("deposits-create",{attrs:{"with-modal":e.withModalForLaunch},on:{refresh:e.modalRefresh,refreshList:e.refreshList,close:e.modalClose}}):e._e()],1):e._e()],1)],1)},n=[],s=a("c7eb"),r=a("1da1"),l=a("5530"),o=(a("caad"),a("d81d"),a("b0c0"),a("e9c4"),a("b64b"),a("a573"),a("277f")),p=a("429f"),d=a("2f62"),c=a("1aac"),_=a("1825"),m=a("ed08"),u={components:{detailModal:c["a"],depositsCreate:_["default"]},props:{withModal:{type:Object,default:void 0}},data:function(){return{showDetailModal:!1,modalFreshControl:!0,withModalForLaunch:{},state_name:"",permit_type_name:"",showIsTop:!1,istop:!1,canyuShow:!0,showSubmitBtn:!0,state:"",typeStatus:!1,fileUrl:[],preViewImg:!1,active:0,details:{},itemArray:[],permit_response:void 0}},mounted:function(){this.initHandler()},methods:Object(l["a"])(Object(l["a"])({},Object(d["c"])("app",["OPEN_PREVIEW"])),{},{toProjectDetail:function(){var e=this,t=e.permit_response.info;"未签约"===t.main_contract_id?Object(m["c"])(this,"NewProject",{data:JSON.stringify(t),type:"edit",isTop:t.istop}):Object(m["c"])(this,"projectDetail",{id:t.id,isTop:t.istop})},initHandler:function(){var e,t,a,i;if(this.withModal){if(this.state_name=null===(e=this.withModal.permit_row)||void 0===e?void 0:e.state_name,this.permit_type_name=null===(t=this.withModal.permit_row)||void 0===t?void 0:t.permit_type_name,this.istop=null===(a=this.withModal.permit_row)||void 0===a?void 0:a.isTop,this.showIsTop=0===(null===(i=this.withModal.permit_row)||void 0===i?void 0:i.state),this.withModal.hide_permit_btn&&(this.canyuShow=!1),this.getDetails(),this.withModal.type){var n=this.withModal.type;switch(n){case"edit":this.typeStatus=!1;break;case"audit":this.showSubmitBtn=!1,this.typeStatus=!0,this.permitsGetInfoFun({id:this.withModal.permit_id});break;default:break}}}else this.state_name=this.$route.query.state_name,this.permit_type_name=this.$route.query.permit_type_name,this.istop="1"===this.$route.query.isTop,this.showIsTop="0"===this.$route.query.state,this.$route.query.canyuShow||void 0===this.$route.query.canyuShow||(this.canyuShow=this.$route.query.canyuShow),this.getDetails(),this.$route.query.type&&(this.typeStatus=Boolean(this.$route.query.type),this.canyuShow&&this.permitsGetInfoFun({id:this.$route.query.shenpiId}),this.showSubmitBtn=!this.$route.query.type)},refreshList:function(){this.initHandler()},modalRefresh:function(){var e=this;this.modalFreshControl=!1,this.$nextTick((function(){e.modalFreshControl=!0}))},modalClose:function(){this.showDetailModal=!1,this.withModalForLaunch=void 0},handleTop:function(e){var t=this;return Object(r["a"])(Object(s["a"])().mark((function e(){var a;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(o["a"])({id:t.$route.query.shenpiId});case 2:a=e.sent,200==a.code&&(t.$message.success(a.msg),t.istop=!t.istop);case 4:case"end":return e.stop()}}),e)})))()},handlePass:function(e){var t=this;return Object(r["a"])(Object(s["a"])().mark((function e(){var a;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(p["j"])({id:t.$route.query.shenpiId,type:"1"});case 2:a=e.sent,200==a.code&&(t.$message.success(a.msg),t.$router.push({name:"pendApprovalList"}));case 4:case"end":return e.stop()}}),e)})))()},handleReject:function(e){var t=this;return Object(r["a"])(Object(s["a"])().mark((function e(){var a;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(p["j"])({id:t.$route.query.shenpiId,type:"2"});case 2:a=e.sent,200==a.code&&(t.$message.success(a.msg),t.$router.push({name:"pendApprovalList"}));case 4:case"end":return e.stop()}}),e)})))()},permitsGetInfoFun:function(e){var t=this;return Object(r["a"])(Object(s["a"])().mark((function a(){var i,n,r;return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(o["z"])(e);case 2:if(i=a.sent,t.state=i.data.state,n=i.data.project_id,!n){a.next=10;break}return a.next=8,Object(p["e"])(n);case 8:r=a.sent,t.permit_response=Object(l["a"])(Object(l["a"])({},i.data),{},{info:r.data[0]||{}});case 10:case"end":return a.stop()}}),a)})))()},getDetails:function(){var e=this;return Object(r["a"])(Object(s["a"])().mark((function t(){var a,i,n;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.withModal?e.withModal.id?e.withModal.id:null===(i=e.withModal.permit_row)||void 0===i?void 0:i.bind_id:e.$route.query.id,t.next=3,Object(o["d"])({id:a});case 3:n=t.sent,e.typeStatus=0===n.data.permitting_state,2===n.data.permitting_state&&(n.data.permit_process[n.data.phase-1].name="已驳回"),e.details=n.data,n.data.permit_process.map((function(t,a){2===t.state&&(e.active=a+1)}));case 8:case"end":return t.stop()}}),t)})))()},handleDetails:function(e,t,a){this.withModalForLaunch={step:e,id:t,data:Object(l["a"])(Object(l["a"])({},a),{},{client_compan_id:this.details.client_company_id}),type:"edit"},this.showDetailModal=!0},handlePreView:function(e){this.preViewImg=!0;var t=JSON.parse(this.details["step_".concat(e)].file);this.fileUrl=t},handleDownLoad:function(){},handleReceipt:function(e){var t,a=e.split(".").pop();["pdf"].includes(a)&&(t="pdf"),["doc","docx"].includes(a)&&(t="doc"),["png","jpg","jpeg","gif","bmp"].includes(a)&&(t="pic"),this.OPEN_PREVIEW({url:e,type:t})}})},y=u,f=(a("b9bb"),a("2877")),b=Object(f["a"])(y,i,n,!1,null,"7a89e96c",null);t["default"]=b.exports},"7cce":function(e,t,a){"use strict";a("1423")},9437:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var i=a("b775");function n(e){return Object(i["a"])({url:"Publics/upload",method:"post",data:e,headers:{"content-type":"multipart/form-data"}})}},"9a04":function(e,t,a){e.exports=a.p+"static/img/checking.73c367ae.png"},ac6f:function(e,t,a){e.exports=a.p+"static/img/refuted.d21e0353.png"},ace5:function(e,t,a){},b9bb:function(e,t,a){"use strict";a("ace5")},ed08:function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return l}));a("53ca"),a("d81d"),a("a434"),a("d3b7"),a("4d63"),a("ac1f"),a("2c3e"),a("00b4"),a("25f0"),a("4d90"),a("5319"),a("0643"),a("4e3e"),a("a573"),a("159b");var i=a("21a6"),n=a("25ca");a("bc3a"),a("aeb1");function s(e,t,a,s){var r=[],l=[],o=function(e){var t=0;for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t++;return t};for(var p in e)if(console.log("------------------------"),Object.prototype.hasOwnProperty.call(e,p)){var d=e[p],c=[];for(var _ in d)if(Object.prototype.hasOwnProperty.call(d,_)){var m=d[_];c.push(m),l.length<o(d)&&l.push(_)}r.push(c)}var u=[];a.map((function(e,t){"快速操作"!=e&&"详情"!=e&&u.push(e)})),r.splice(0,0,l,u),console.log("excel_data",n);var y=n["utils"].aoa_to_sheet(r),f=n["utils"].book_new(),b=[{hidden:!0}];y["!rows"]=b,n["utils"].book_append_sheet(f,y,s);var v=n["write"](f,{bookType:"xlsx",type:"array"}),h=new Blob([v],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});Object(i["saveAs"])(h,t+".xlsx")}function r(e){var t=-1!==e.lastIndexOf("?")?decodeURIComponent(e.substring(e.lastIndexOf("/")+1,e.lastIndexOf("?"))):decodeURIComponent(e.substring(e.lastIndexOf("/")+1)),a=t.substring(t.lastIndexOf(".")+1);if("png"==a||"jpg"==a||"pdf"==a){var n=document.createElement("a");n.href=e,n.download=t,n.target="_blank",n.click()}else fetch(e,{mode:"no-cors"}).then((function(e){return e.blob()})).then((function(e){console.log("blob",e),Object(i["saveAs"])(e,t)}))}function l(e,t,a){console.log("self",e);var i=e.$router.resolve({name:t,query:a}),n=window.open(i.href,t);n&&n.location.reload()}}}]);